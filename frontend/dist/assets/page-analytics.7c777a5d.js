import{u as e,R as t,j as a,r,E as n,a as i,D as s,C as o,P as l,b as c,c as d}from"./vendor-react.862bc4d9.js";import{C as h,P as x,B as u,d as m,T as p,a as g,b as f,c as y,u as j,G as v,e as b,F as C,I as w,S,M as k,f as A,A as I,g as D,h as R,i as M,j as T,k as $,D as z,l as P,m as F,n as B,o as E,p as L,q as W,r as O,s as U,t as V,v as K,w as _,x as N,y as q,z as G,E as H,H as J,J as X,K as Y,L as Q,N as Z,O as ee,Q as te,R as ae,U as re,V as ne,W as ie,X as se,Y as oe,Z as le,_ as ce,$ as de,a0 as he,a1 as xe,a2 as ue,a3 as me,a4 as pe,a5 as ge,a6 as fe,a7 as ye,a8 as je,a9 as ve,aa as be,ab as Ce,ac as we,ad as Se,ae as ke,af as Ae,ag as Ie,ah as De,ai as Re,aj as Me,ak as Te,al as $e,am as ze,an as Pe,ao as Fe,ap as Be,aq as Ee,ar as Le,as as We,at as Oe,au as Ue,av as Ve,aw as Ke,ax as _e,ay as Ne,az as qe,aA as Ge,aB as He,aC as Je}from"./vendor-mui.1e5c58eb.js";import{R as Xe,L as Ye,C as Qe,X as Ze,Y as et,T as tt,a as at,b as rt,P as nt,c as it,d as st,B as ot,e as lt,f as ct,g as dt,h as ht,i as xt}from"./vendor-charts.6105f747.js";import{a as ut,f as mt,b as pt,i as gt,s as ft}from"./vendor-utils.787fabe2.js";import{a as yt,h as jt,E as vt}from"./vendor.def2142b.js";let bt=async()=>Promise.reject(new Error("refreshToken function not initialized")),Ct=!1,wt=[];const St=ut.create({baseURL:"https://staging-api.tangible-studios.com",timeout:1e4,headers:{"Content-Type":"application/json"}}),kt=e=>{bt=e},At=(e,t=null)=>{wt.forEach((a=>{e?a(Promise.reject(e)):t&&a(t)})),wt=[]};St.interceptors.request.use((async e=>{var t;try{const r=()=>{const e=localStorage.getItem("token_expiry");if(!e)return!1;const t=parseInt(e,10);return Date.now()>=t-3e5},n=null==(t=e.url)?void 0:t.includes("/auth/refresh");if(r()&&!Ct&&!n){Ct=!0;try{const t=(await bt()).access_token;e.headers&&(e.headers.Authorization=`Bearer ${t}`),At(null,t)}catch(a){return At(a,null),Promise.reject(a)}finally{Ct=!1}}}catch(r){}return e}),(e=>Promise.reject(e))),St.interceptors.response.use((e=>e),(async e=>{var t;const a=e.config;if(401===(null==(t=e.response)?void 0:t.status)&&!a._retry){if(Ct)return new Promise(((e,t)=>{wt.push((r=>{"string"==typeof r?(a.headers.Authorization=`Bearer ${r}`,e(St(a))):t(r)}))}));a._retry=!0,Ct=!0;try{const e=(await bt()).access_token;return a.headers.Authorization=`Bearer ${e}`,At(null,e),St(a)}catch(r){return At(r,null),Promise.reject(r)}finally{Ct=!1}}return e.response||e.request,Promise.reject(e)}));const It={get:(e,t={})=>St.get(e,{params:t}).then((e=>e.data)),post:(e,t={},a={})=>St.post(e,t,a).then((e=>e.data)),put:(e,t={},a={})=>St.put(e,t,a).then((e=>e.data)),patch:(e,t={},a={})=>St.patch(e,t,a).then((e=>e.data)),delete:(e,t={})=>St.delete(e,t).then((e=>e.data))},Dt=()=>{const e=()=>{navigator.onLine};return window.addEventListener("online",e),window.addEventListener("offline",e),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",e)}},Rt=({error:r,resetErrorBoundary:n})=>{const i=e();return t.useEffect((()=>{}),[r]),a.jsx(h,{maxWidth:"md",sx:{py:8},children:a.jsx(x,{elevation:3,sx:{p:4,borderRadius:2},children:a.jsxs(u,{display:"flex",flexDirection:"column",alignItems:"center",gap:3,children:[a.jsx(m,{color:"error",sx:{fontSize:64}}),a.jsx(p,{variant:"h4",component:"h1",gutterBottom:!0,children:"Something went wrong"}),a.jsx(p,{variant:"body1",color:"text.secondary",align:"center",children:"We encountered an unexpected error. Our team has been notified."}),!1,a.jsxs(u,{display:"flex",gap:2,mt:2,children:[a.jsx(g,{variant:"contained",color:"primary",onClick:n,startIcon:a.jsx(f,{}),children:"Try again"}),a.jsx(g,{variant:"outlined",onClick:()=>{i("/"),n()},startIcon:a.jsx(y,{}),children:"Go to home page"})]})]})})})},Mt=e=>{if("featureUsage"===e){const e=Array.from({length:30},((e,t)=>({date:new Date(Date.now()-24*(29-t)*60*60*1e3).toISOString().split("T")[0],aiAssistant:Math.floor(1e3*Math.random())+500,collaboration:Math.floor(800*Math.random())+300,contentCreation:Math.floor(1200*Math.random())+600,dashboard:Math.floor(500*Math.random())+200}))),t=[{name:"Authenticated",value:2341,percentage:65.3},{name:"Anonymous",value:892,percentage:24.9},{name:"API",value:351,percentage:9.8}],a=[],r=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],n=["0-4","4-8","8-12","12-16","16-20","20-24"];for(let i=0;i<r.length;i++)for(let e=0;e<n.length;e++)a.push({x:r[i],y:n[e],value:Math.floor(100*Math.random())+5});return{dailyUsage:e,userTypeDistribution:t,heatmapData:a,heatmapXLabels:r,heatmapYLabels:n,adoptionRates:[{feature:"AI Assistant",rate:78},{feature:"Collaboration",rate:64},{feature:"Content Creation",rate:92},{feature:"Dashboard",rate:81}],keyMetrics:[{name:"Total Users",value:"3,584",change:12.5},{name:"Avg. Session Duration",value:"8:24",change:5.2},{name:"Features Used Per Session",value:"3.2",change:.8},{name:"Collaboration Rate",value:"72%",change:18.3}]}}if("aiAssistant"===e){return{dailyMetrics:Array.from({length:30},((e,t)=>({date:new Date(Date.now()-24*(29-t)*60*60*1e3).toISOString().split("T")[0],acceptanceRate:Math.floor(30*Math.random())+60,qualityScore:Math.floor(20*Math.random())+70}))),suggestionTypes:[{name:"Grammar",value:3218,percentage:42.3},{name:"Rephrase",value:1672,percentage:22},{name:"Expand",value:1254,percentage:16.5},{name:"Summarize",value:947,percentage:12.5},{name:"Other",value:513,percentage:6.7}],responseTimes:Array.from({length:30},((e,t)=>({date:new Date(Date.now()-24*(29-t)*60*60*1e3).toISOString().split("T")[0],averageResponseTime:Math.floor(200*Math.random())+100}))),cachePerformance:Array.from({length:30},((e,t)=>({date:new Date(Date.now()-24*(29-t)*60*60*1e3).toISOString().split("T")[0],hitRate:Math.floor(30*Math.random())+40}))),insights:[{title:"Highest Acceptance Rates",description:"Grammar suggestions have the highest acceptance rate at 78%, while expansion suggestions are only accepted 42% of the time.",metrics:{label:"Acceptance Rate Gap",value:"36%"}},{title:"Cache Performance",description:"The suggestion cache is currently providing a 62% hit rate, reducing average response time by 248ms.",metrics:{label:"Time Saved",value:"248ms"}},{title:"Quality Improvement",description:"The perceived quality score has increased by 12 points over the past month, correlating with the new model deployment.",metrics:{label:"Quality Increase",value:"+12 pts"}}]}}if("websocket"===e){return{connectionCounts:Array.from({length:30},((e,t)=>({date:new Date(Date.now()-24*(29-t)*60*60*1e3).toISOString().split("T")[0],activeConnections:Math.floor(500*Math.random())+200}))),messageVolume:Array.from({length:30},((e,t)=>({date:new Date(Date.now()-24*(29-t)*60*60*1e3).toISOString().split("T")[0],sent:Math.floor(1e4*Math.random())+5e3,received:Math.floor(8e3*Math.random())+3e3}))),latency:Array.from({length:30},((e,t)=>({date:new Date(Date.now()-24*(29-t)*60*60*1e3).toISOString().split("T")[0],averageLatency:Math.floor(80*Math.random())+20}))),errorRate:Array.from({length:30},((e,t)=>({date:new Date(Date.now()-24*(29-t)*60*60*1e3).toISOString().split("T")[0],errorRate:2*Math.random()}))),summary:[{metric:"Peak Connections",value:"754"},{metric:"Avg. Latency",value:"48ms"},{metric:"Messages/Day",value:"15.2K"},{metric:"Error Rate",value:"0.8%"}]}}if("userJourneys"===e){return{nodes:[{id:"entry",type:"entry",name:"Login/Entry",count:5e3,conversionRate:100},{id:"dashboard",type:"page",name:"Dashboard",count:4850,conversionRate:97,dropoffRate:3},{id:"content",type:"page",name:"Content List",count:3200,conversionRate:66,dropoffRate:34},{id:"create",type:"action",name:"Create Content",count:2100,conversionRate:65.6,dropoffRate:34.4},{id:"editor",type:"page",name:"Content Editor",count:2e3,conversionRate:95.2,dropoffRate:4.8},{id:"aiAssist",type:"action",name:"Use AI Assistant",count:1650,conversionRate:82.5,dropoffRate:17.5},{id:"collaborate",type:"action",name:"Invite Collaborator",count:780,conversionRate:39,dropoffRate:61},{id:"review",type:"decision",name:"Review Content",count:1850,conversionRate:92.5,dropoffRate:7.5},{id:"publish",type:"action",name:"Publish Content",count:1720,conversionRate:93,dropoffRate:7},{id:"exit",type:"exit",name:"Exit",count:5e3,dropoffRate:100}],connections:[{source:"entry",target:"dashboard",value:4850,percentage:97},{source:"dashboard",target:"content",value:3200,percentage:66},{source:"content",target:"create",value:2100,percentage:65.6},{source:"create",target:"editor",value:2e3,percentage:95.2},{source:"editor",target:"aiAssist",value:1650,percentage:82.5},{source:"aiAssist",target:"collaborate",value:780,percentage:47.3},{source:"aiAssist",target:"review",value:870,percentage:52.7},{source:"collaborate",target:"review",value:780,percentage:100},{source:"review",target:"publish",value:1720,percentage:93},{source:"review",target:"editor",value:130,percentage:7},{source:"publish",target:"exit",value:1720,percentage:100},{source:"dashboard",target:"exit",value:150,percentage:3.1},{source:"content",target:"exit",value:1100,percentage:34.4},{source:"editor",target:"exit",value:100,percentage:5},{source:"aiAssist",target:"exit",value:0,percentage:0}],conversionRates:Array.from({length:30},((e,t)=>({date:new Date(Date.now()-24*(29-t)*60*60*1e3).toISOString().split("T")[0],contentCreation:Math.floor(20*Math.random())+60,collaboration:Math.floor(30*Math.random())+40,publishing:Math.floor(15*Math.random())+75}))),journeyTimes:Array.from({length:30},((e,t)=>({date:new Date(Date.now()-24*(29-t)*60*60*1e3).toISOString().split("T")[0],contentCreation:Math.floor(300*Math.random())+600,collaboration:Math.floor(500*Math.random())+1200,publishing:Math.floor(200*Math.random())+300})))}}if("abTest"===e){const e=[{id:"control",name:"Control",description:"Current UI"},{id:"variantA",name:"Variant A",description:"Simplified UI"},{id:"variantB",name:"Variant B",description:"Enhanced Collaboration"}],t=[{key:"conversionRate",name:"Conversion Rate",formatter:e=>`${e.toFixed(1)}%`,higherIsBetter:!0},{key:"timeOnTask",name:"Time on Task",formatter:e=>`${e}s`,higherIsBetter:!1},{key:"engagementScore",name:"Engagement Score",formatter:e=>`${e.toFixed(1)}`,higherIsBetter:!0},{key:"errorRate",name:"Error Rate",formatter:e=>`${e.toFixed(1)}%`,higherIsBetter:!1}],a=[{variant:"control",conversionRate:24.3,timeOnTask:127,engagementScore:6.2,errorRate:3.8},{variant:"variantA",conversionRate:29.7,timeOnTask:103,engagementScore:7.1,errorRate:2.9},{variant:"variantB",conversionRate:31.2,timeOnTask:118,engagementScore:8.4,errorRate:3.2}],r={};t.forEach((t=>{r[t.key]=Array.from({length:30},((r,n)=>{const i={date:new Date(Date.now()-24*(29-n)*60*60*1e3).toISOString().split("T")[0]};return e.forEach((e=>{var r;const n=(null==(r=a.find((t=>t.variant===e.id)))?void 0:r[t.key])||0,s=.9+.2*Math.random();i[e.id]=n*s})),i}))}));return{variants:e,metrics:t,results:a,timeSeriesData:r,insights:[{title:"Variant B Shows Highest Engagement",description:"Variant B demonstrates a 35.5% increase in engagement score compared to control, suggesting that enhanced collaboration features significantly improve user engagement.",isPositive:!0,confidence:98},{title:"Variant A Reduces Time on Task",description:"The simplified UI in Variant A reduces time on task by 18.9% compared to control, improving efficiency without sacrificing quality of output.",isPositive:!0,confidence:95},{title:"Error Rates Improved in Both Variants",description:"Both test variants show lower error rates than control, with Variant A showing the largest improvement at 23.7% reduction.",isPositive:!0,confidence:91}]}}if("uxInsights"===e){const e=new Date;return[{id:"insight-1",title:"AI Assistant Suggestions Boost Productivity",description:"Users who actively utilize AI assistant suggestions complete content creation 43% faster than users who don't. The highest impact is seen with grammar and rephrasing suggestions.",category:"performance",severity:"high",trend:"up",percent:43,createdAt:new Date(e.getTime()-72e5).toISOString(),metrics:[{name:"Time Saved",value:"18 min/article",change:43,trend:"up"},{name:"Acceptance Rate",value:"76%",change:12,trend:"up"},{name:"Quality Improvement",value:"8.2/10",change:18,trend:"up"}],isNew:!0},{id:"insight-2",title:"Collaborative Editing Drop-offs",description:"There's a 24% drop-off rate when users attempt to initiate collaborative editing sessions. Session logs indicate confusion around permission settings may be the cause.",category:"anomaly",severity:"medium",trend:"down",percent:24,createdAt:new Date(e.getTime()-288e5).toISOString(),metrics:[{name:"Initiation Success Rate",value:"76%",change:-24,trend:"down"},{name:"Error Rate",value:"18%",change:130,trend:"up"},{name:"Avg Session Duration",value:"14 min",change:-8,trend:"down"}]},{id:"insight-3",title:"Increasing Mobile Usage Trend",description:"Mobile usage of the platform has increased by 37% over the past month, but mobile sessions are 28% shorter than desktop sessions. Consider optimizing mobile collaboration features.",category:"trend",severity:"medium",trend:"up",percent:37,createdAt:new Date(e.getTime()-864e5).toISOString(),metrics:[{name:"Mobile Traffic",value:"32%",change:37,trend:"up"},{name:"Mobile Session Length",value:"8.4 min",change:-28,trend:"down"},{name:"Mobile Conversion",value:"18%",change:-12,trend:"down"}],isNew:!0},{id:"insight-4",title:"Content Template Usage Opportunity",description:"Only 23% of users utilize content templates, but those who do complete content 58% faster with 32% higher quality scores. Increasing template visibility could significantly improve productivity.",category:"opportunity",severity:"high",createdAt:new Date(e.getTime()-2592e5).toISOString(),metrics:[{name:"Template Usage",value:"23%",change:5,trend:"up"},{name:"Time Saving",value:"58%",change:0,trend:"flat"},{name:"Quality Increase",value:"32%",change:0,trend:"flat"}]},{id:"insight-5",title:"Predicted Impact of New Feature Rollout",description:"Based on user behavior analysis and A/B test results, the new collaborative commenting feature is predicted to increase user engagement by 27% and reduce revision cycles by 14% when fully rolled out.",category:"prediction",severity:"medium",trend:"up",percent:27,createdAt:new Date(e.getTime()-432e5).toISOString(),metrics:[{name:"Engagement Increase",value:"27%",change:0,trend:"flat"},{name:"Revision Reduction",value:"14%",change:0,trend:"flat"},{name:"User Satisfaction",value:"8.7/10",change:12,trend:"up"}]}]}return null},Tt=()=>({getFeatureUsageMetrics:r.useCallback((async e=>{try{return Mt("featureUsage")}catch(t){throw t}}),[]),getAIAssistantMetrics:r.useCallback((async e=>{try{return Mt("aiAssistant")}catch(t){throw t}}),[]),getWebSocketMetrics:r.useCallback((async e=>{try{return Mt("websocket")}catch(t){throw t}}),[]),getUserJourneys:r.useCallback((async e=>{try{return Mt("userJourneys")}catch(t){throw t}}),[]),getABTestResults:r.useCallback((async e=>{try{return Mt("abTest")}catch(t){throw t}}),[]),getUXInsights:r.useCallback((async e=>{try{return Mt("uxInsights")}catch(t){throw t}}),[]),getDashboardData:r.useCallback((async e=>{try{return{featureUsage:Mt("featureUsage"),aiAssistant:Mt("aiAssistant"),websocket:Mt("websocket"),userJourneys:Mt("userJourneys"),abTest:Mt("abTest"),insights:Mt("uxInsights")}}catch(t){throw t}}),[])}),$t=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(e),zt=e=>`${(100*e).toFixed(1)}%`,Pt=e=>e>=1e6?`${(e/1e6).toFixed(1)}M`:e>=1e3?`${(e/1e3).toFixed(1)}K`:e.toString(),Ft=["#0088FE","#00C49F","#FFBB28","#FF8042","#A569BD","#5DADE2","#48C9B0"],Bt=e=>{const{children:t,value:r,index:n,...i}=e;return a.jsx("div",{role:"tabpanel",hidden:r!==n,id:`api-metrics-tabpanel-${n}`,"aria-labelledby":`api-metrics-tab-${n}`,...i,children:r===n&&a.jsx(u,{sx:{p:3},children:t})})},Et=()=>{const e=j(),[t,i]=r.useState(0),[s,o]=r.useState(new Date(Date.now()-2592e6).toISOString().split("T")[0]),[l,c]=r.useState((new Date).toISOString().split("T")[0]),[d,h]=r.useState(""),{useDailyCosts:m,useProviderCosts:f,useModelCosts:y,useBudgetStatus:P,useCacheMetrics:F,useErrorRates:B,useAgentUsage:E}=Tt(),{data:L=[],isLoading:W,error:O,refetch:U}=m(s,l,d),{data:V={},isLoading:K,error:_,refetch:N}=f(s,l),{data:q=[],isLoading:G,error:H,refetch:J}=y(s,l,d),{data:X={},isLoading:Y,error:Q,refetch:Z}=P(),{data:ee={cache_hit_ratio:0,estimated_savings:0,total_requests:0,cached_requests:0},isLoading:te,error:ae,refetch:re}=F(s,l),{data:ne={},isLoading:ie,error:se,refetch:oe}=B(s,l),{data:le=[],isLoading:ce,error:de,refetch:he}=E(s,l),xe=W||K||G||Y||te||ie||ce,ue=O||_||H||Q||ae||se||de,me=()=>{U(),N(),J(),Z(),re(),oe(),he()},pe=L.reduce(((e,t)=>{const a=e.find((e=>e.date===t.date));if(a)a[t.provider]=(a[t.provider]||0)+t.cost_usd;else{const a={date:t.date,[t.provider]:t.cost_usd};e.push(a)}return e}),[]);pe.sort(((e,t)=>new Date(e.date).getTime()-new Date(t.date).getTime()));const ge=Object.keys(V||{}),fe=q.map((e=>({name:`${e.provider}: ${e.model}`,cost:e.cost_usd,tokens:e.tokens,provider:e.provider}))),ye=ee.total_requests?[{name:"Cached Requests",value:ee.cached_requests},{name:"API Requests",value:ee.total_requests-ee.cached_requests}]:[],je=le.map((e=>({name:e.agent_type,tokens:e.total_tokens,cost:e.cost_usd,requests:e.request_count})));return a.jsx(n,{FallbackComponent:Rt,children:a.jsxs(u,{children:[a.jsxs(u,{sx:{mb:4,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[a.jsx(p,{variant:"h4",component:"h1",fontWeight:"bold",children:"AI API Usage Metrics"}),a.jsx(g,{variant:"contained",onClick:me,children:"Refresh Data"})]}),a.jsx(x,{sx:{p:2,mb:3},children:a.jsxs(v,{container:!0,spacing:2,alignItems:"center",children:[a.jsx(v,{item:!0,xs:12,md:3,children:a.jsx(b,{label:"Start Date",type:"date",value:s,onChange:e=>o(e.target.value),fullWidth:!0,InputLabelProps:{shrink:!0}})}),a.jsx(v,{item:!0,xs:12,md:3,children:a.jsx(b,{label:"End Date",type:"date",value:l,onChange:e=>c(e.target.value),fullWidth:!0,InputLabelProps:{shrink:!0}})}),a.jsx(v,{item:!0,xs:12,md:3,children:a.jsxs(C,{fullWidth:!0,children:[a.jsx(w,{children:"Provider"}),a.jsxs(S,{value:d,label:"Provider",onChange:e=>{h(e.target.value)},children:[a.jsx(k,{value:"",children:"All Providers"}),ge.map((e=>a.jsx(k,{value:e,children:e},e)))]})]})}),a.jsx(v,{item:!0,xs:12,md:3,children:a.jsx(g,{variant:"outlined",fullWidth:!0,onClick:me,children:"Apply Filters"})})]})}),xe&&a.jsx(u,{sx:{display:"flex",justifyContent:"center",py:4},children:a.jsx(A,{})}),ue&&a.jsx(I,{severity:"error",sx:{mb:2},children:ue.message||"An error occurred while fetching data"}),a.jsxs(u,{sx:{mb:4},children:[a.jsx(p,{variant:"h5",component:"h2",gutterBottom:!0,children:"Budget Status"}),a.jsx(v,{container:!0,spacing:3,children:Object.entries(X).map((([e,t])=>a.jsx(v,{item:!0,xs:12,md:6,children:a.jsxs(D,{children:[a.jsx(R,{title:`${e.charAt(0).toUpperCase()+e.slice(1)} Budget`,subheader:`Monthly Budget: ${$t(t.monthly_budget)}`}),a.jsxs(M,{children:[a.jsx(p,{variant:"h4",color:"text.secondary",gutterBottom:!0,children:$t(t.current_spend)}),a.jsxs(p,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:[t.budget_percent.toFixed(1),"% of monthly budget used"]}),a.jsx(u,{sx:{height:10,bgcolor:"grey.300",borderRadius:5,mb:2,position:"relative"},children:a.jsx(u,{sx:{height:"100%",borderRadius:5,width:`${Math.min(t.budget_percent,100)}%`,bgcolor:"high"===t.warning_level?"error.main":"medium"===t.warning_level?"warning.main":"success.main"}})}),a.jsxs(p,{variant:"body2",color:t.projected_percent>100?"error":"text.secondary",children:["Projected End of Month: ",$t(t.projected_month_end),t.projected_percent>100&&a.jsxs("span",{children:[" (",$t(t.estimated_overage)," over budget)"]})]})]})]})},e)))})]}),a.jsxs(x,{sx:{width:"100%",mb:4},children:[a.jsxs(T,{value:t,onChange:(e,t)=>{i(t)},indicatorColor:"primary",textColor:"primary",variant:"scrollable",scrollButtons:"auto",children:[a.jsx($,{label:"Cost Overview"}),a.jsx($,{label:"Model Usage"}),a.jsx($,{label:"Cache Performance"}),a.jsx($,{label:"Error Rates"}),a.jsx($,{label:"Agent Usage"})]}),a.jsxs(Bt,{value:t,index:0,children:[a.jsx(p,{variant:"h6",gutterBottom:!0,children:"Daily Cost Trend"}),a.jsx(u,{sx:{height:400,mb:4},children:a.jsx(Xe,{width:"100%",height:"100%",children:a.jsxs(Ye,{data:pe,children:[a.jsx(Qe,{strokeDasharray:"3 3"}),a.jsx(Ze,{dataKey:"date"}),a.jsx(et,{tickFormatter:e=>$t(e)}),a.jsx(tt,{formatter:e=>$t(Number(e))}),a.jsx(at,{}),ge.map(((e,t)=>a.jsx(rt,{type:"monotone",dataKey:e,stroke:Ft[t%Ft.length],activeDot:{r:8}},e)))]})})}),a.jsx(p,{variant:"h6",gutterBottom:!0,children:"Provider Cost Distribution"}),a.jsx(u,{sx:{height:400},children:a.jsx(Xe,{width:"100%",height:"100%",children:a.jsxs(nt,{children:[a.jsx(it,{dataKey:"value",nameKey:"name",data:Object.entries(V).map((([e,t])=>({name:e,value:t}))),cx:"50%",cy:"50%",outerRadius:150,fill:"#8884d8",label:({name:e,percent:t})=>`${e} (${(100*t).toFixed(0)}%)`,children:Object.keys(V).map(((e,t)=>a.jsx(st,{fill:Ft[t%Ft.length]},`cell-${t}`)))}),a.jsx(tt,{formatter:e=>$t(Number(e))})]})})})]}),a.jsxs(Bt,{value:t,index:1,children:[a.jsx(p,{variant:"h6",gutterBottom:!0,children:"Cost by Model"}),a.jsx(u,{sx:{height:400,mb:4},children:a.jsx(Xe,{width:"100%",height:"100%",children:a.jsxs(ot,{data:fe,children:[a.jsx(Qe,{strokeDasharray:"3 3"}),a.jsx(Ze,{dataKey:"name"}),a.jsx(et,{yAxisId:"left",tickFormatter:e=>$t(e)}),a.jsx(et,{yAxisId:"right",orientation:"right",dataKey:"tokens",tickFormatter:Pt}),a.jsx(tt,{formatter:(e,t)=>["cost"===t?$t(Number(e)):Pt(Number(e)),"cost"===t?"Cost":"Tokens"]}),a.jsx(at,{}),a.jsx(lt,{yAxisId:"left",dataKey:"cost",name:"Cost",fill:"#8884d8",children:fe.map(((e,t)=>a.jsx(st,{fill:Ft[ge.indexOf(e.provider)%Ft.length]},`cell-${t}`)))}),a.jsx(lt,{yAxisId:"right",dataKey:"tokens",name:"Tokens",fill:"#82ca9d",opacity:.7})]})})}),a.jsx(p,{variant:"h6",gutterBottom:!0,children:"Model Details"}),a.jsx(v,{container:!0,spacing:2,children:q.map((e=>a.jsx(v,{item:!0,xs:12,md:6,lg:4,children:a.jsxs(D,{children:[a.jsx(R,{title:e.model,subheader:e.provider}),a.jsxs(M,{children:[a.jsxs(p,{variant:"body1",color:"text.primary",children:["Cost: ",$t(e.cost_usd)]}),a.jsxs(p,{variant:"body2",color:"text.secondary",children:["Tokens: ",Pt(e.tokens)]}),a.jsxs(p,{variant:"body2",color:"text.secondary",children:["Cost per 1K tokens: ",$t(e.cost_per_1k_tokens)]}),a.jsxs(p,{variant:"body2",color:"text.secondary",children:["Requests: ",e.requests," (",e.cached_requests," cached)"]}),a.jsxs(p,{variant:"body2",color:"text.secondary",children:["Cache Hit Rate: ",zt(e.cache_hit_ratio)]})]})]})},`${e.provider}-${e.model}`)))})]}),a.jsx(Bt,{value:t,index:2,children:a.jsxs(v,{container:!0,spacing:3,children:[a.jsx(v,{item:!0,xs:12,md:6,children:a.jsxs(D,{children:[a.jsx(R,{title:"Cache Metrics"}),a.jsxs(M,{children:[a.jsx(p,{variant:"h5",color:"primary",gutterBottom:!0,children:zt(ee.cache_hit_ratio)}),a.jsx(p,{variant:"body1",children:"Cache Hit Ratio"}),a.jsx(z,{sx:{my:2}}),a.jsxs(p,{variant:"body1",color:"text.secondary",gutterBottom:!0,children:["Estimated Savings: ",$t(ee.estimated_savings)]}),a.jsxs(p,{variant:"body2",color:"text.secondary",children:["Total Requests: ",ee.total_requests]}),a.jsxs(p,{variant:"body2",color:"text.secondary",children:["Cached Requests: ",ee.cached_requests]})]})]})}),a.jsx(v,{item:!0,xs:12,md:6,children:a.jsx(u,{sx:{height:300},children:a.jsx(Xe,{width:"100%",height:"100%",children:a.jsxs(nt,{children:[a.jsxs(it,{data:ye,dataKey:"value",nameKey:"name",cx:"50%",cy:"50%",outerRadius:100,fill:"#8884d8",label:({name:e,percent:t})=>`${e} (${(100*t).toFixed(0)}%)`,children:[a.jsx(st,{fill:e.palette.primary.main}),a.jsx(st,{fill:e.palette.grey[400]})]}),a.jsx(tt,{formatter:e=>Pt(Number(e))}),a.jsx(at,{})]})})})})]})}),a.jsxs(Bt,{value:t,index:3,children:[a.jsx(p,{variant:"h6",gutterBottom:!0,children:"API Error Rates by Provider"}),a.jsx(v,{container:!0,spacing:3,children:Object.entries(ne).map((([e,t])=>a.jsx(v,{item:!0,xs:12,md:6,children:a.jsxs(D,{children:[a.jsx(R,{title:`${e.charAt(0).toUpperCase()+e.slice(1)} Errors`,subheader:`Total Requests: ${t.total_requests}`}),a.jsxs(M,{children:[a.jsx(p,{variant:"h4",color:t.error_rate>.05?"error":"text.secondary",gutterBottom:!0,children:zt(t.error_rate)}),a.jsxs(p,{variant:"body2",color:"text.secondary",children:["Failed Requests: ",t.failed_requests]}),a.jsx(u,{sx:{height:10,bgcolor:"grey.300",borderRadius:5,mt:2,position:"relative"},children:a.jsx(u,{sx:{height:"100%",borderRadius:5,width:`${Math.min(100*t.error_rate*10,100)}%`,bgcolor:t.error_rate>.05?"error.main":"success.main"}})}),t.error_rate>.05&&a.jsx(I,{severity:"warning",sx:{mt:2},children:"Error rate exceeds recommended threshold (5%)"})]})]})},e)))})]}),a.jsxs(Bt,{value:t,index:4,children:[a.jsx(p,{variant:"h6",gutterBottom:!0,children:"Agent Usage"}),a.jsx(u,{sx:{height:400,mb:4},children:a.jsx(Xe,{width:"100%",height:"100%",children:a.jsxs(ot,{data:je,children:[a.jsx(Qe,{strokeDasharray:"3 3"}),a.jsx(Ze,{dataKey:"name"}),a.jsx(et,{yAxisId:"left",tickFormatter:e=>$t(e)}),a.jsx(et,{yAxisId:"right",orientation:"right",dataKey:"tokens",tickFormatter:Pt}),a.jsx(tt,{formatter:(e,t)=>["cost"===t?$t(Number(e)):Pt(Number(e)),"cost"===t?"Cost":"tokens"===t?"Tokens":"Requests"]}),a.jsx(at,{}),a.jsx(lt,{yAxisId:"left",dataKey:"cost",name:"Cost",fill:"#8884d8"}),a.jsx(lt,{yAxisId:"right",dataKey:"tokens",name:"Tokens",fill:"#82ca9d"})]})})}),a.jsx(p,{variant:"h6",gutterBottom:!0,children:"Agent Details"}),a.jsx(v,{container:!0,spacing:2,children:le.map(((e,t)=>a.jsx(v,{item:!0,xs:12,md:6,lg:4,children:a.jsxs(D,{children:[a.jsx(R,{title:e.agent_type,subheader:`${e.request_count} Requests`}),a.jsxs(M,{children:[a.jsxs(p,{variant:"body1",color:"text.primary",children:["Cost: ",$t(e.cost_usd)]}),a.jsxs(p,{variant:"body2",color:"text.secondary",children:["Total Tokens: ",Pt(e.total_tokens)]}),a.jsxs(p,{variant:"body2",color:"text.secondary",children:["Avg. Tokens per Request: ",e.avg_tokens_per_request.toFixed(0)]})]})]})},e.agent_type)))})]})]})]})})},Lt={highContrast:!1,colorBlindMode:"none",patternFill:!1,includeDataTableWithCharts:!1,enhancedLabels:!0,keyboardNavigation:!0,tooltipDelay:3e3,verboseDescriptions:!1,announceDataChanges:!1},Wt=r.createContext({config:Lt,updateConfig:()=>{},getColorBlindSafeColors:()=>[],getPatternStyles:()=>[],generateChartSummary:()=>""}),Ot=({children:e})=>{const[t,n]=r.useState((()=>{const e=localStorage.getItem("chartAccessibilityConfig");return e?JSON.parse(e):Lt}));i((e=>{var t;return null==(t=e.ui)?void 0:t.darkMode}));const s=i((e=>{var t;return null==(t=e.ui)?void 0:t.currentTheme}))||"default";r.useEffect((()=>{"string"==typeof s&&s.includes("highContrast")&&n((e=>({...e,highContrast:!0})))}),[s]);const o={config:t,updateConfig:e=>{n((t=>{const a={...t,...e};return localStorage.setItem("chartAccessibilityConfig",JSON.stringify(a)),a}))},getColorBlindSafeColors:()=>({none:["#4153AF","#E8543E","#69BE64","#B85DD9","#F3AC41","#5DBBC5","#D35CBA","#63A875","#D2CA4E","#6F7B88","#AA655F","#3793C9"],protanopia:["#004488","#DDAA33","#BB5566","#000000","#FFCC00","#009988","#775500","#AABBCC","#FFFFFF","#99DDFF","#444444","#FFDD99"],deuteranopia:["#004488","#DDAA33","#BB5566","#000000","#FFCC00","#009988","#775500","#AABBCC","#FFFFFF","#99DDFF","#444444","#FFDD99"],tritanopia:["#EE7733","#0077BB","#33BBEE","#EE3377","#CC3311","#009988","#BBBBBB","#000000","#FFFFFF","#AA4499","#DDDDDD","#332288"],achromatopsia:["#000000","#575757","#9E9E9E","#FFFFFF","#1A1A1A","#3B3B3B","#737373","#ABABAB","#C8C8C8","#E0E0E0","#303030","#4F4F4F"]}[t.colorBlindMode]),getPatternStyles:()=>t.patternFill?[{backgroundImage:"linear-gradient(45deg, rgba(0,0,0,0.1) 25%, transparent 25%, transparent 50%, rgba(0,0,0,0.1) 50%, rgba(0,0,0,0.1) 75%, transparent 75%, transparent)",backgroundSize:"10px 10px"},{backgroundImage:"linear-gradient(135deg, rgba(0,0,0,0.1) 25%, transparent 25%, transparent 50%, rgba(0,0,0,0.1) 50%, rgba(0,0,0,0.1) 75%, transparent 75%, transparent)",backgroundSize:"10px 10px"},{backgroundImage:"radial-gradient(circle, rgba(0,0,0,0.1) 25%, transparent 25%, transparent 50%, rgba(0,0,0,0.1) 50%, rgba(0,0,0,0.1) 75%, transparent 75%, transparent)",backgroundSize:"10px 10px"},{backgroundImage:"linear-gradient(90deg, rgba(0,0,0,0.1) 50%, transparent 50%)",backgroundSize:"10px 10px"},{backgroundImage:"linear-gradient(0deg, rgba(0,0,0,0.1) 50%, transparent 50%)",backgroundSize:"10px 10px"},{backgroundImage:"repeating-linear-gradient(45deg, rgba(0,0,0,0.1), rgba(0,0,0,0.1) 5px, transparent 5px, transparent 10px)"},{backgroundImage:"repeating-linear-gradient(135deg, rgba(0,0,0,0.1), rgba(0,0,0,0.1) 5px, transparent 5px, transparent 10px)"},{backgroundImage:"linear-gradient(45deg, rgba(0,0,0,0.1) 25%, transparent 25%), linear-gradient(-45deg, rgba(0,0,0,0.1) 25%, transparent 25%), linear-gradient(45deg, transparent 75%, rgba(0,0,0,0.1) 75%), linear-gradient(-45deg, transparent 75%, rgba(0,0,0,0.1) 75%)",backgroundSize:"10px 10px"}]:[],generateChartSummary:(e,t,a)=>{if(!t||0===t.length)return`${e}: No data available.`;let r=`${e}: `;if("timeSeries"===a){const a=t.map((e=>e.value)).filter((e=>"number"==typeof e)),n=t.map((e=>e.date));if(0===a.length)return`${e}: No numeric data available.`;const i=Math.max(...a),s=Math.min(...a),o=a.indexOf(i),l=a.indexOf(s);if(r+=`Time series data from ${n[0]} to ${n[n.length-1]}. `,r+=`Highest value: ${i} on ${n[o]}. `,r+=`Lowest value: ${s} on ${n[l]}. `,a.length>1){const e=a[0],t=a[a.length-1]-e,n=(t/Math.abs(e)*100).toFixed(1);r+=t>0?`Overall upward trend of ${n}% from beginning to end.`:t<0?`Overall downward trend of ${n}% from beginning to end.`:"No overall change from beginning to end."}}else if("distribution"===a){const e=t.reduce(((e,t)=>e+t.value),0);r+=`Distribution data with ${t.length} categories. `;const a=[...t].sort(((e,t)=>t.value-e.value)),n=a.slice(0,Math.min(3,a.length));r+="Top categories: ",n.forEach(((t,a)=>{const i=(t.value/e*100).toFixed(1);r+=`${t.name} (${i}%)${a<n.length-1?", ":". "}`})),r+=`Total value across all categories: ${e}.`}else r+=`Chart contains ${t.length} data points. `;return r}};return a.jsx(Wt.Provider,{value:o,children:e})},Ut=()=>r.useContext(Wt),Vt=({title:e,description:r,data:n,columns:i,caption:s,compact:o=!1,hideByDefault:l=!0})=>{const c=j(),[d,h]=t.useState(!l);return n&&0!==n.length?a.jsxs(u,{mt:2,p:2,border:1,borderColor:"divider",borderRadius:1,role:"region","aria-label":`Data table for ${e}`,children:[a.jsxs(u,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:1,sx:{cursor:"pointer"},onClick:()=>h(!d),children:[a.jsxs(p,{variant:"subtitle2",component:"h3",children:[e," - Data Table"]}),a.jsx(P,{"aria-label":d?"Collapse data table":"Expand data table",size:"small",children:d?a.jsx(F,{}):a.jsx(B,{})})]}),r&&a.jsx(p,{variant:"body2",color:"text.secondary",mb:1,children:r}),a.jsx(E,{in:d,children:a.jsx(L,{component:x,elevation:0,sx:{maxHeight:o?240:400,border:`1px solid ${c.palette.divider}`},children:a.jsxs(W,{"aria-label":s||e,size:o?"small":"medium",stickyHeader:!0,children:[s&&a.jsx("caption",{style:{captionSide:"top",padding:"8px"},children:s}),a.jsx(O,{children:a.jsx(U,{children:i.map((e=>a.jsx(V,{sx:{fontWeight:"bold",backgroundColor:"dark"===c.palette.mode?c.palette.grey[800]:c.palette.grey[100]},scope:"col",children:e.label},e.id)))})}),a.jsx(K,{children:n.map(((e,t)=>a.jsx(U,{hover:!0,tabIndex:0,sx:{"&:nth-of-type(odd)":{backgroundColor:c.palette.action.hover}},children:i.map(((r,n)=>{const i=e[r.id];return 0===n?a.jsx(V,{scope:"row",sx:{fontWeight:"medium"},children:r.format?r.format(i):i},`cell-${t}-${r.id}`):a.jsx(V,{children:r.format?r.format(i):i},`cell-${t}-${r.id}`)}))},`row-${t}`)))})]})})})]}):a.jsxs(u,{mt:2,p:2,border:1,borderColor:"divider",borderRadius:1,children:[a.jsxs(p,{variant:"subtitle2",component:"h3",children:[e," - Data Table"]}),a.jsx(p,{variant:"body2",children:"No data available."})]})},Kt=({onClose:e})=>{j();const{config:t,updateConfig:r}=Ut(),n=e=>t=>{r({[e]:t.target.checked})};return a.jsx(D,{children:a.jsxs(M,{children:[a.jsxs(u,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,children:[a.jsx(p,{variant:"h6",component:"h2",children:"Chart Accessibility Settings"}),a.jsx(g,{size:"small",startIcon:a.jsx(_,{}),onClick:()=>{r(Lt)},variant:"outlined",children:"Reset Defaults"})]}),a.jsx(p,{variant:"body2",color:"text.secondary",paragraph:!0,children:"Customize how charts are displayed and interacted with to improve accessibility."}),a.jsx(z,{sx:{my:2}}),a.jsx(p,{variant:"subtitle1",gutterBottom:!0,fontWeight:"medium",children:"Visual Settings"}),a.jsxs(N,{children:[a.jsx(q,{control:a.jsx(G,{checked:t.highContrast,onChange:n("highContrast"),inputProps:{"aria-label":"Toggle high contrast mode"}}),label:a.jsxs(u,{display:"flex",alignItems:"center",children:["High Contrast Mode",a.jsx(H,{title:"Increases contrast in charts for better visibility",children:a.jsx(P,{size:"small",sx:{ml:.5},children:a.jsx(J,{fontSize:"small"})})})]})}),a.jsx(q,{control:a.jsx(G,{checked:t.patternFill,onChange:n("patternFill"),inputProps:{"aria-label":"Toggle pattern fills"}}),label:a.jsxs(u,{display:"flex",alignItems:"center",children:["Use Patterns in Addition to Colors",a.jsx(H,{title:"Adds patterns to chart elements to help distinguish them without relying solely on color",children:a.jsx(P,{size:"small",sx:{ml:.5},children:a.jsx(J,{fontSize:"small"})})})]})}),a.jsx(u,{mt:2,mb:1,children:a.jsxs(C,{fullWidth:!0,size:"small",children:[a.jsx(w,{id:"color-blind-mode-label",children:"Color Blind Mode"}),a.jsxs(S,{labelId:"color-blind-mode-label",id:"color-blind-mode",value:t.colorBlindMode,label:"Color Blind Mode",onChange:e=>{const t=e.target.value;r({colorBlindMode:t})},children:[a.jsx(k,{value:"none",children:"None"}),a.jsx(k,{value:"protanopia",children:"Protanopia (Red-Blind)"}),a.jsx(k,{value:"deuteranopia",children:"Deuteranopia (Green-Blind)"}),a.jsx(k,{value:"tritanopia",children:"Tritanopia (Blue-Blind)"}),a.jsx(k,{value:"achromatopsia",children:"Achromatopsia (Monochromacy)"})]})]})})]}),a.jsx(z,{sx:{my:2}}),a.jsx(p,{variant:"subtitle1",gutterBottom:!0,fontWeight:"medium",children:"Text and Screen Reader"}),a.jsxs(N,{children:[a.jsx(q,{control:a.jsx(G,{checked:t.includeDataTableWithCharts,onChange:n("includeDataTableWithCharts"),inputProps:{"aria-label":"Toggle data tables with charts"}}),label:a.jsxs(u,{display:"flex",alignItems:"center",children:["Include Data Tables with Charts",a.jsx(H,{title:"Adds accessible HTML tables with the chart data below each chart",children:a.jsx(P,{size:"small",sx:{ml:.5},children:a.jsx(J,{fontSize:"small"})})})]})}),a.jsx(q,{control:a.jsx(G,{checked:t.enhancedLabels,onChange:n("enhancedLabels"),inputProps:{"aria-label":"Toggle enhanced labels"}}),label:a.jsxs(u,{display:"flex",alignItems:"center",children:["Enhanced Text Labels",a.jsx(H,{title:"Adds more descriptive labels to charts for better understanding",children:a.jsx(P,{size:"small",sx:{ml:.5},children:a.jsx(J,{fontSize:"small"})})})]})}),a.jsx(q,{control:a.jsx(G,{checked:t.verboseDescriptions,onChange:n("verboseDescriptions"),inputProps:{"aria-label":"Toggle verbose descriptions"}}),label:a.jsxs(u,{display:"flex",alignItems:"center",children:["Verbose Chart Descriptions",a.jsx(H,{title:"Provides detailed summaries of chart data for screen readers",children:a.jsx(P,{size:"small",sx:{ml:.5},children:a.jsx(J,{fontSize:"small"})})})]})}),a.jsx(q,{control:a.jsx(G,{checked:t.announceDataChanges,onChange:n("announceDataChanges"),inputProps:{"aria-label":"Toggle announce data changes"}}),label:a.jsxs(u,{display:"flex",alignItems:"center",children:["Announce Data Changes",a.jsx(H,{title:"Screen readers will announce when chart data changes",children:a.jsx(P,{size:"small",sx:{ml:.5},children:a.jsx(J,{fontSize:"small"})})})]})})]}),a.jsx(z,{sx:{my:2}}),a.jsx(p,{variant:"subtitle1",gutterBottom:!0,fontWeight:"medium",children:"Interaction Settings"}),a.jsxs(N,{children:[a.jsx(q,{control:a.jsx(G,{checked:t.keyboardNavigation,onChange:n("keyboardNavigation"),inputProps:{"aria-label":"Toggle keyboard navigation"}}),label:a.jsxs(u,{display:"flex",alignItems:"center",children:["Keyboard Navigation",a.jsx(H,{title:"Enables navigating chart data points using keyboard arrow keys",children:a.jsx(P,{size:"small",sx:{ml:.5},children:a.jsx(J,{fontSize:"small"})})})]})}),a.jsxs(u,{mt:2,children:[a.jsxs(p,{id:"tooltip-delay-slider",gutterBottom:!0,children:["Tooltip Display Duration (ms): ",t.tooltipDelay]}),a.jsx(X,{"aria-labelledby":"tooltip-delay-slider",value:t.tooltipDelay,onChange:(e,t)=>{r({tooltipDelay:t})},step:500,marks:!0,min:1e3,max:5e3,valueLabelDisplay:"auto",sx:{width:"100%"}})]})]}),e&&a.jsx(u,{display:"flex",justifyContent:"flex-end",mt:3,children:a.jsx(g,{variant:"contained",onClick:e,children:"Save Settings"})})]})})};let _t=0;const Nt=({chartRef:e,chartType:t,data:a,dataKeys:n,onFocusChange:i,onActivate:s,debug:o=!1})=>{const{config:l}=Ut(),[c,d]=r.useState(l.keyboardNavigation),[h,x]=r.useState([-1,-1]),[u,m]=r.useState([]),p=r.useRef("chart-"+_t++),g=r.useRef(null);r.useEffect((()=>{if(!g.current){const e=document.createElement("div");e.id=`${p.current}-announcer`,e.setAttribute("role","status"),e.setAttribute("aria-live","polite"),e.style.position="absolute",e.style.width="1px",e.style.height="1px",e.style.overflow="hidden",e.style.clip="rect(0 0 0 0)",e.style.clipPath="inset(50%)",document.body.appendChild(e),g.current=e}return()=>{g.current&&document.body.removeChild(g.current)}}),[]),r.useEffect((()=>{d(l.keyboardNavigation)}),[l.keyboardNavigation]);const f=()=>{if(!e.current||!c)return;const r=e.current,i=[];try{switch(t){case"line":case"area":n.forEach(((e,t)=>{const n=[],s=r.querySelectorAll(".recharts-line-dot, .recharts-active-dot");Array.from(s).forEach((t=>{const r=(t.getAttribute("class")||"").match(/recharts-dot-(\d+)/);if(r){const i=parseInt(r[1],10);i>=0&&i<a.length&&n.push({element:t,dataIndex:i,dataKey:e,value:a[i][e],date:a[i].date||a[i].formattedDate})}})),n.length>0&&(i[t]=n)}));break;case"bar":n.forEach(((e,t)=>{const n=[],s=r.querySelectorAll(".recharts-bar-rectangle");Array.from(s).forEach((t=>{if(t.querySelector("path")){const r=t.getAttribute("data-index");if(r){const i=parseInt(r,10);i>=0&&i<a.length&&n.push({element:t,dataIndex:i,dataKey:e,value:a[i][e]})}}})),n.length>0&&(i[t]=n)}));break;case"pie":const e=r.querySelectorAll(".recharts-pie-sector"),t=[];Array.from(e).forEach(((e,r)=>{r<a.length&&t.push({element:e,dataIndex:r,value:a[r].value,dataKey:a[r].name})})),t.length>0&&(i[0]=t)}m(i),o&&i.length}catch(s){}};r.useEffect((()=>{if(!c||!e.current)return;const a=setTimeout((()=>{f()}),500);return e.current&&(e.current.setAttribute("tabindex","0"),e.current.setAttribute("role","application"),e.current.setAttribute("aria-label",`Interactive ${t} chart. Use arrow keys to navigate data points.`)),()=>clearTimeout(a)}),[c,e.current,a,n,t]);const y=(e,a)=>{if(!u[a]||!u[a][e])return;const r=u[a][e];if(r.element&&(r.element.setAttribute("tabindex","0"),r.element.focus(),r.element instanceof SVGElement&&(r.element.setAttribute("stroke-width","3"),r.element.setAttribute("stroke","currentColor"),u.forEach((e=>{e.forEach((e=>{e!==r&&e.element instanceof SVGElement&&e.element.setAttribute("stroke-width","1")}))})))),i&&i({dataIndex:r.dataIndex,dataKey:r.dataKey,value:r.value}),g.current){let e="";"line"===t||"area"===t?(e=`${r.dataKey||"Series"}, `,e+=r.date?`Date: ${r.date}, `:"",e+=`Value: ${r.value}`):e="pie"===t?`${r.dataKey}: ${r.value}`:`${r.dataKey||"Series"}: ${r.value}`,g.current.textContent=e}};return r.useEffect((()=>{c&&f()}),[a,c]),{handleKeyDown:e=>{var t;if(!c||0===u.length)return;const[a,r]=h;if(-1===a||-1===r)return void(u[0]&&u[0][0]&&(x([0,0]),y(0,0)));let n=a,i=r;switch(e.key){case"ArrowRight":a<((null==(t=u[r])?void 0:t.length)||0)-1&&(n=a+1);break;case"ArrowLeft":a>0&&(n=a-1);break;case"ArrowUp":r>0&&(i=r-1,u[i]&&(n=Math.min(a,u[i].length-1)));break;case"ArrowDown":r<u.length-1&&(i=r+1,u[i]&&(n=Math.min(a,u[i].length-1)));break;case"Enter":case" ":if(u[r]&&u[r][a]){const t=u[r][a];s&&s({dataIndex:t.dataIndex,dataKey:t.dataKey,value:t.value}),e.preventDefault()}return;default:return}n===a&&i===r||(x([n,i]),y(n,i))},focusableElements:u,focusIndex:h,chartId:p.current,enabled:c}},qt=(e,t,a,r)=>{if(!e)return;e.setAttribute("role","img"),e.setAttribute("aria-label",`${t}. ${a}`);const n=`This is a ${r} chart. `;a?a.includes(n)||e.setAttribute("aria-label",`${t}. ${n}${a}`):e.setAttribute("aria-label",`${t}. ${n}`)},Gt=(e,t)=>{r.useEffect((()=>{e.current&&(e.current.setAttribute("role","status"),e.current.setAttribute("aria-live","polite"),e.current.setAttribute("aria-label",`${t} tooltip`))}),[e.current,t])},Ht=({title:e,description:t,data:n,dataKeys:i,colors:s,yAxisLabel:o,xAxisLabel:l,formatValue:c=e=>e.toString(),formatTooltip:d,height:h=300,referenceLines:x,referencePoints:m,compareWith:g,showControls:f=!1,annotations:y,onExport:v})=>{const b=j(),C=r.useRef(null),w=r.useRef(null),[S,A]=r.useState(null),[I,R]=r.useState("line"),[T,$]=r.useState(1),[z,F]=r.useState(!1),[B,E]=r.useState(!1),[L,W]=r.useState(!1),[O,U]=r.useState(null),{config:V,getColorBlindSafeColors:K,generateChartSummary:_}=Ut(),{handleKeyDown:N,chartId:q,enabled:G}=Nt({chartRef:C,chartType:I,data:n,dataKeys:i,onFocusChange:e=>{U(e)},onActivate:e=>{}});r.useEffect((()=>{W(V.includeDataTableWithCharts)}),[V.includeDataTableWithCharts]),r.useEffect((()=>{C.current&&qt(C.current,e,t||"","area"===I?"area":"line")}),[e,t,I,C.current]),Gt(w,e);const J=()=>{A(null)},X=e=>{v&&v(e),J()},ce=()=>{E(!B)},de=(()=>{if("none"!==V.colorBlindMode)return K();const e=[b.palette.primary.main,b.palette.secondary.main,b.palette.success.main,b.palette.error.main,b.palette.warning.main,b.palette.info.main];return s||e})(),he=r.useMemo((()=>n.map((e=>({...e,formattedDate:mt(new Date(e.date),"MMM dd")})))),[n]),xe=r.useMemo((()=>[{id:"formattedDate",label:"Date"},...i.map((e=>({id:e,label:e,format:e=>c(e)})))]),[i,c]),ue=r.useMemo((()=>_(e,n,"timeSeries")),[e,n,_]),me=({active:e,payload:t,label:r})=>e&&t&&t.length?a.jsxs(D,{sx:{p:1,border:`1px solid ${b.palette.divider}`},ref:w,role:"status","aria-live":"polite",children:[a.jsx(p,{variant:"body2",sx:{mb:1,fontWeight:"bold"},children:r}),t.map(((e,t)=>a.jsxs(u,{sx:{display:"flex",alignItems:"center",mb:.5},children:[a.jsx(u,{component:"span",sx:{width:12,height:12,borderRadius:"50%",backgroundColor:e.color,display:"inline-block",mr:1,...V.patternFill?{backgroundImage:"linear-gradient(45deg, rgba(0,0,0,0.1) 25%, transparent 25%, transparent 50%, rgba(0,0,0,0.1) 50%, rgba(0,0,0,0.1) 75%, transparent 75%, transparent)",backgroundSize:"10px 10px"}:{}},role:"presentation","aria-hidden":"true"}),a.jsxs(p,{variant:"body2",component:"span",sx:{mr:1},children:[e.name,":"]}),a.jsx(p,{variant:"body2",component:"span",sx:{fontWeight:"bold"},children:d?d(e.value,e.name,e):c(e.value)})]},`tooltip-${t}`)))]}):null;return a.jsxs(a.Fragment,{children:[a.jsx(D,{sx:{height:z?"100vh":"100%",position:z?"fixed":"relative",top:0,left:0,right:0,bottom:0,zIndex:z?1300:"auto","&:focus-visible":{outline:`2px solid ${b.palette.primary.main}`,outlineOffset:"2px"}},children:a.jsxs(M,{sx:{height:"100%",display:"flex",flexDirection:"column",p:z?3:void 0},children:[a.jsxs(u,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:1},children:[a.jsxs(u,{children:[a.jsx(p,{variant:"h6",component:"h3",id:`${q}-title`,children:e}),t&&a.jsx(p,{variant:"body2",color:"text.secondary",id:`${q}-desc`,children:t}),V.verboseDescriptions&&a.jsx(p,{sx:{position:"absolute",width:"1px",height:"1px",padding:0,margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:0},"aria-live":"polite",children:ue})]}),f&&a.jsxs(u,{sx:{display:"flex",alignItems:"center"},children:[a.jsxs(Y,{size:"small",value:I,exclusive:!0,onChange:(e,t)=>{null!==t&&R(t)},"aria-label":"chart type",sx:{mr:1},children:[a.jsx(Q,{value:"line","aria-label":"line chart",children:"Line"}),a.jsx(Q,{value:"area","aria-label":"area chart",children:"Area"})]}),a.jsx(H,{title:"Zoom in",children:a.jsx(P,{size:"small",onClick:()=>{$((e=>Math.min(e+.2,2)))},sx:{mr:.5},"aria-label":"Zoom in",children:a.jsx(Z,{fontSize:"small"})})}),a.jsx(H,{title:"Zoom out",children:a.jsx(P,{size:"small",onClick:()=>{$((e=>Math.max(e-.2,.5)))},sx:{mr:.5},"aria-label":"Zoom out",children:a.jsx(ee,{fontSize:"small"})})}),a.jsx(H,{title:z?"Exit fullscreen":"Fullscreen",children:a.jsx(P,{size:"small",onClick:()=>{F(!z)},sx:{mr:.5},"aria-label":z?"Exit fullscreen":"Enter fullscreen",children:a.jsx(te,{fontSize:"small"})})}),a.jsx(H,{title:"Data table",children:a.jsx(P,{size:"small",onClick:()=>{W(!L)},sx:{mr:.5},"aria-label":"Toggle data table","aria-pressed":L,children:a.jsx(ae,{fontSize:"small"})})}),a.jsx(H,{title:"Accessibility settings",children:a.jsx(P,{size:"small",onClick:ce,sx:{mr:.5},"aria-label":"Open accessibility settings",children:a.jsx(re,{fontSize:"small"})})}),a.jsx(H,{title:"More options",children:a.jsx(P,{size:"small",onClick:e=>{A(e.currentTarget)},"aria-label":"More options","aria-haspopup":"true","aria-expanded":Boolean(S),children:a.jsx(ne,{fontSize:"small"})})}),a.jsxs(ie,{anchorEl:S,open:Boolean(S),onClose:J,id:`${q}-menu`,children:[a.jsx(k,{onClick:()=>X("png"),children:"Export as PNG"}),a.jsx(k,{onClick:()=>X("svg"),children:"Export as SVG"}),a.jsx(k,{onClick:()=>X("csv"),children:"Export as CSV"})]})]})]}),g&&a.jsx(u,{sx:{mb:2},children:a.jsx(se,{label:`Comparing with: ${g.label}`,size:"small",color:"primary",variant:"outlined"})}),a.jsx(u,{sx:{flexGrow:1,width:"100%",height:"string"==typeof h?h:`${h}px`,transform:`scale(${T})`,transformOrigin:"center center"},ref:C,tabIndex:G?0:-1,onKeyDown:N,"aria-labelledby":`${q}-title`,"aria-describedby":`${q}-desc`,role:"application","aria-roledescription":"time series chart",children:a.jsx(Xe,{width:"100%",height:"100%",children:a.jsxs(Ye,{data:he,margin:{top:10,right:30,left:20,bottom:25},children:[a.jsx(Qe,{strokeDasharray:"3 3",stroke:b.palette.divider}),a.jsx(Ze,{dataKey:"formattedDate",tick:{fontSize:12},stroke:b.palette.text.secondary,label:l&&V.enhancedLabels?{value:l,position:"insideBottom",offset:-15,style:{fill:b.palette.text.primary,fontSize:12,fontWeight:"bold"}}:l?{value:l,position:"insideBottom",offset:-15}:void 0,tickMargin:8}),a.jsx(et,{tick:{fontSize:12},stroke:b.palette.text.secondary,tickFormatter:c,label:o&&V.enhancedLabels?{value:o,angle:-90,position:"insideLeft",style:{fill:b.palette.text.primary,fontSize:12,fontWeight:"bold"}}:o?{value:o,angle:-90,position:"insideLeft"}:void 0,tickMargin:8}),a.jsx(tt,{content:a.jsx(me,{}),wrapperStyle:{outline:"none"}}),a.jsx(at,{wrapperStyle:{paddingTop:10},formatter:(e,t)=>a.jsx("span",{style:{color:t.color,fontWeight:V.highContrast?"bold":"normal"},children:e})}),g&&a.jsx(ct,{x1:g.startDate,x2:g.endDate,strokeOpacity:.3,stroke:g.color||b.palette.primary.main,fill:g.color||b.palette.primary.main,fillOpacity:.1,ifOverflow:"extendDomain"}),null==x?void 0:x.map(((e,t)=>a.jsx(dt,{y:e.value,stroke:e.color||b.palette.warning.main,strokeDasharray:"3 3",strokeWidth:V.highContrast?2:1,label:{value:e.label,position:"right",fill:e.color||b.palette.warning.main,fontSize:12,fontWeight:V.highContrast?"bold":"normal"},ifOverflow:"extendDomain"},`ref-line-${t}`))),null==m?void 0:m.map(((e,t)=>a.jsx(ht,{x:e.date,y:e.value,r:V.highContrast?8:6,fill:e.color||b.palette.error.main,stroke:V.highContrast?b.palette.common.white:"none",strokeWidth:V.highContrast?2:0,ifOverflow:"extendDomain"},`ref-point-${t}`))),i.map(((e,t)=>a.jsx(rt,{type:"monotone",dataKey:e,name:e,stroke:de[t%de.length],fill:"area"===I?de[t%de.length]:void 0,fillOpacity:"area"===I?V.highContrast?.3:.2:0,activeDot:{r:V.highContrast?10:8,stroke:V.highContrast?b.palette.common.white:void 0,strokeWidth:V.highContrast?2:0},strokeWidth:V.highContrast?3:2,dot:{r:4,strokeWidth:1},connectNulls:!0},e)))]})})}),y&&y.length>0&&a.jsxs(u,{sx:{mt:2,pt:1,borderTop:`1px solid ${b.palette.divider}`},role:"region","aria-label":"Chart annotations",children:[a.jsx(p,{variant:"subtitle2",gutterBottom:!0,children:"Annotations:"}),a.jsx(u,{sx:{display:"flex",flexWrap:"wrap",gap:1},children:y.map(((e,t)=>a.jsx(se,{label:`${mt(new Date(e.date),"MMM dd")}: ${e.text}`,size:"small",sx:{borderColor:e.color||b.palette.info.main,color:e.color||b.palette.info.main,borderWidth:V.highContrast?2:1,fontWeight:V.highContrast?"bold":"normal"},variant:"outlined"},`annotation-${t}`)))})]}),L&&a.jsx(Vt,{title:e,description:t,data:he,columns:xe,caption:`Table representation of ${e} chart data`,hideByDefault:!1})]})}),a.jsx(oe,{open:B,onClose:ce,"aria-labelledby":"accessibility-settings-title",maxWidth:"sm",fullWidth:!0,children:a.jsx(le,{children:a.jsx(Kt,{onClose:ce})})})]})},Jt=({title:e,description:n,data:i,colors:s,height:o=300,formatValue:l=e=>e.toString(),formatPercentage:c=e=>`${e.toFixed(1)}%`,showLegend:d=!0,centerLabel:h,showControls:x=!1,onExport:m})=>{const g=j(),f=r.useRef(null),y=r.useRef(null),[v,b]=r.useState(null),[C,w]=r.useState(!1),[S,A]=r.useState(!1),[I,R]=r.useState(null),{config:T,getColorBlindSafeColors:$,generateChartSummary:z}=Ut(),{handleKeyDown:F,chartId:B,enabled:E}=Nt({chartRef:f,chartType:"pie",data:i,dataKeys:["value"],onFocusChange:e=>{R(e)},onActivate:e=>{}});r.useEffect((()=>{A(T.includeDataTableWithCharts)}),[T.includeDataTableWithCharts]),r.useEffect((()=>{f.current&&qt(f.current,e,n||"","pie")}),[e,n,f.current]),Gt(y,e);const L=()=>{b(null)},W=e=>{m&&m(e),L()},O=()=>{w(!C)},U=(()=>{if("none"!==T.colorBlindMode)return $();const e=[g.palette.primary.main,g.palette.secondary.main,g.palette.success.main,g.palette.error.main,g.palette.warning.main,g.palette.info.main,g.palette.primary.light,g.palette.secondary.light,g.palette.success.light,g.palette.error.light,g.palette.warning.light,g.palette.info.light];return s||e})(),V=t.useMemo((()=>{const e=i.reduce(((e,t)=>e+t.value),0);return i.map((t=>({...t,percentage:t.percentage||t.value/e*100})))}),[i]),K=t.useMemo((()=>[{id:"name",label:"Category"},{id:"value",label:"Value",format:l},{id:"percentage",label:"Percentage",format:c}]),[l,c]),_=t.useMemo((()=>z(e,i,"distribution")),[e,i,z]),N=({active:e,payload:t})=>{if(e&&t&&t.length){const e=t[0].payload;return a.jsxs(D,{sx:{p:1,border:`1px solid ${g.palette.divider}`},ref:y,role:"status","aria-live":"polite",children:[a.jsx(p,{variant:"body2",sx:{fontWeight:"bold"},children:e.name}),a.jsxs(u,{sx:{display:"flex",justifyContent:"space-between",mt:.5},children:[a.jsx(p,{variant:"body2",component:"span",color:"text.secondary",sx:{mr:2},children:"Value:"}),a.jsx(p,{variant:"body2",component:"span",sx:{fontWeight:T.highContrast?"bold":"medium"},children:l(e.value)})]}),a.jsxs(u,{sx:{display:"flex",justifyContent:"space-between",mt:.5},children:[a.jsx(p,{variant:"body2",component:"span",color:"text.secondary",sx:{mr:2},children:"Percentage:"}),a.jsx(p,{variant:"body2",component:"span",sx:{fontWeight:T.highContrast?"bold":"medium"},children:c(e.percentage||0)})]})]})}return null},q=()=>a.jsx("text",{x:"50%",y:"50%",textAnchor:"middle",dominantBaseline:"middle",style:{fontFamily:g.typography.fontFamily,fontSize:T.highContrast?g.typography.h6.fontSize:g.typography.body1.fontSize,fontWeight:T.highContrast?"bold":"normal",fill:g.palette.text.primary},"aria-hidden":"true",children:h});return a.jsxs(a.Fragment,{children:[a.jsx(D,{sx:{height:"100%","&:focus-visible":{outline:`2px solid ${g.palette.primary.main}`,outlineOffset:"2px"}},children:a.jsxs(M,{sx:{height:"100%",display:"flex",flexDirection:"column"},children:[a.jsxs(u,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:1},children:[a.jsxs(u,{children:[a.jsx(p,{variant:"h6",component:"h3",id:`${B}-title`,children:e}),n&&a.jsx(p,{variant:"body2",color:"text.secondary",id:`${B}-desc`,children:n}),T.verboseDescriptions&&a.jsx(p,{sx:{position:"absolute",width:"1px",height:"1px",padding:0,margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:0},"aria-live":"polite",children:_})]}),x&&a.jsxs(u,{sx:{display:"flex",alignItems:"center"},children:[a.jsx(H,{title:"Data table",children:a.jsx(P,{size:"small",onClick:()=>{A(!S)},sx:{mr:.5},"aria-label":"Toggle data table","aria-pressed":S,children:a.jsx(ae,{fontSize:"small"})})}),a.jsx(H,{title:"Accessibility settings",children:a.jsx(P,{size:"small",onClick:O,sx:{mr:.5},"aria-label":"Open accessibility settings",children:a.jsx(re,{fontSize:"small"})})}),a.jsx(H,{title:"More options",children:a.jsx(P,{size:"small",onClick:e=>{b(e.currentTarget)},"aria-label":"More options","aria-haspopup":"true","aria-expanded":Boolean(v),children:a.jsx(ne,{fontSize:"small"})})}),a.jsxs(ie,{anchorEl:v,open:Boolean(v),onClose:L,id:`${B}-menu`,children:[a.jsx(k,{onClick:()=>W("png"),children:"Export as PNG"}),a.jsx(k,{onClick:()=>W("svg"),children:"Export as SVG"}),a.jsx(k,{onClick:()=>W("csv"),children:"Export as CSV"})]})]})]}),a.jsx(u,{sx:{flexGrow:1,width:"100%",height:o},ref:f,tabIndex:E?0:-1,onKeyDown:F,"aria-labelledby":`${B}-title`,"aria-describedby":`${B}-desc`,role:"application","aria-roledescription":"pie chart",children:a.jsx(Xe,{width:"100%",height:"100%",children:a.jsxs(nt,{children:[a.jsxs(it,{data:V,cx:"50%",cy:"50%",labelLine:!1,outerRadius:"80%",innerRadius:"55%",paddingAngle:T.highContrast?4:2,dataKey:"value",stroke:T.highContrast?g.palette.background.paper:void 0,strokeWidth:T.highContrast?2:0,nameKey:"name",isAnimationActive:!T.announceDataChanges,children:[V.map(((e,t)=>{const r=T.patternFill?{backgroundImage:"linear-gradient(45deg, rgba(0,0,0,0.1) 25%, transparent 25%, transparent 50%, rgba(0,0,0,0.1) 50%, rgba(0,0,0,0.1) 75%, transparent 75%, transparent)",backgroundSize:"10px 10px"}:{};return a.jsx(st,{fill:e.color||U[t%U.length],style:r},`cell-${t}`)})),h&&a.jsx(q,{})]}),a.jsx(tt,{content:a.jsx(N,{}),wrapperStyle:{outline:"none"}}),d&&a.jsx(at,{content:e=>{const{payload:t}=e;return a.jsx(u,{sx:{display:"flex",flexWrap:"wrap",justifyContent:"center",mt:2},role:"list","aria-label":"Chart legend",children:t.map(((e,t)=>{const r=V.find((t=>t.name===e.value));return a.jsxs(u,{sx:{display:"flex",alignItems:"center",mx:1,mb:.5},role:"listitem",children:[a.jsx(u,{component:"span",sx:{width:12,height:12,borderRadius:"50%",backgroundColor:e.color,display:"inline-block",mr:1,...T.patternFill?{backgroundImage:"linear-gradient(45deg, rgba(0,0,0,0.1) 25%, transparent 25%, transparent 50%, rgba(0,0,0,0.1) 50%, rgba(0,0,0,0.1) 75%, transparent 75%, transparent)",backgroundSize:"8px 8px"}:{},border:T.highContrast?`1px solid ${g.palette.common.black}`:"none"},role:"presentation","aria-hidden":"true"}),a.jsx(p,{variant:"body2",sx:{mr:.5,fontWeight:T.highContrast?"bold":"normal"},children:e.value}),a.jsxs(p,{variant:"body2",color:"text.secondary",sx:{fontWeight:T.highContrast?"medium":"normal"},children:["(",c((null==r?void 0:r.percentage)||0),")"]})]},`legend-${t}`)}))})}})]})})}),S&&a.jsx(Vt,{title:e,description:n,data:V,columns:K,caption:`Table representation of ${e} chart data`,hideByDefault:!1,compact:!0})]})}),a.jsx(oe,{open:C,onClose:O,"aria-labelledby":"accessibility-settings-title",maxWidth:"sm",fullWidth:!0,children:a.jsx(le,{children:a.jsx(Kt,{onClose:O})})})]})},Xt=({title:e,description:t,data:n,xLabels:i,yLabels:s,colorScale:o,height:l=400,formatValue:c=e=>e.toString(),onCellClick:d})=>{const h=j(),[x,m]=r.useMemo((()=>{const e=n.map((e=>e.value));return[Math.min(...e),Math.max(...e)]}),[n]),g=[h.palette.primary.light,h.palette.primary.dark],[f,y]=o||g,v=e=>{if(m===x)return f;const t=(e-x)/(m-x),a=e=>{if(e.startsWith("#")){return{r:parseInt(e.slice(1,3),16),g:parseInt(e.slice(3,5),16),b:parseInt(e.slice(5,7),16)}}return{r:0,g:0,b:0}},r=a(f),n=a(y);return`rgb(${Math.round(r.r+(n.r-r.r)*t)}, ${Math.round(r.g+(n.g-r.g)*t)}, ${Math.round(r.b+(n.b-r.b)*t)})`},b=r.useMemo((()=>{const e={};return s.forEach((t=>{e[t]={},i.forEach((a=>{e[t][a]=0}))})),n.forEach((t=>{const a=t.x.toString(),r=t.y.toString();e[r]&&i.includes(a)&&(e[r][a]=t.value)})),e}),[n,i,s]),C=r.useMemo((()=>(("number"==typeof l?l:400)-60)/s.length),[l,s.length]),w=r.useMemo((()=>100/i.length+"%"),[i.length]);return a.jsx(D,{sx:{height:"100%"},children:a.jsxs(M,{sx:{height:"100%",display:"flex",flexDirection:"column"},children:[a.jsx(p,{variant:"h6",component:"div",gutterBottom:!0,children:e}),t&&a.jsx(p,{variant:"body2",color:"text.secondary",sx:{mb:2},children:t}),a.jsx(u,{sx:{flexGrow:1,width:"100%",height:"string"==typeof l?l:`${l}px`,overflow:"auto"},children:a.jsxs(u,{sx:{display:"flex",flexDirection:"column",alignItems:"stretch",minWidth:40*i.length},children:[a.jsx(u,{sx:{display:"flex",ml:8,borderBottom:`1px solid ${h.palette.divider}`},children:i.map((e=>a.jsx(u,{sx:{width:w,textAlign:"center",p:1,fontSize:"0.75rem",fontWeight:"medium",color:h.palette.text.secondary,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",transform:"rotate(-45deg)",transformOrigin:"bottom left",height:40,display:"flex",alignItems:"flex-end"},children:e},`x-${e}`)))}),a.jsx(u,{sx:{display:"flex",flexDirection:"column"},children:s.map((e=>a.jsxs(u,{sx:{display:"flex",alignItems:"center",borderBottom:`1px solid ${h.palette.divider}`},children:[a.jsx(u,{sx:{width:80,p:1,fontSize:"0.75rem",fontWeight:"medium",color:h.palette.text.secondary,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",flexShrink:0},children:e}),a.jsx(u,{sx:{display:"flex",flexGrow:1},children:i.map((t=>{var r;const n=(null==(r=b[e])?void 0:r[t])||0;return a.jsx(u,{sx:{width:w,height:C,display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:v(n),color:h.palette.getContrastText(v(n)),fontSize:"0.75rem",fontWeight:"medium",cursor:d?"pointer":"default",transition:"all 0.2s","&:hover":{boxShadow:`0 0 0 2px ${h.palette.primary.main}`,zIndex:1}},onClick:()=>{return a=t,r=e,i=n,void(d&&d(a,r,i));var a,r,i},title:`${t}, ${e}: ${c(n)}`,children:c(n)},`cell-${e}-${t}`)}))})]},`row-${e}`)))})]})}),a.jsxs(u,{sx:{display:"flex",alignItems:"center",justifyContent:"center",mt:2},children:[a.jsx(u,{sx:{width:200,height:12,borderRadius:1,background:`linear-gradient(to right, ${f}, ${y})`,mr:2}}),a.jsxs(p,{variant:"caption",color:"text.secondary",children:[c(x)," - ",c(m)]})]})]})})},Yt=({title:e,description:t,variants:r,metrics:n,results:i,height:s=400,showRelativeChange:o=!0,confidenceThreshold:l=95,selectedMetric:c,onSelectMetric:d})=>{var h;const x=j(),m=c||(null==(h=n[0])?void 0:h.key),g=n.find((e=>e.key===m)),f=(null==g?void 0:g.formatter)||(e=>`${e.toFixed(2)}`),y=!1!==(null==g?void 0:g.higherIsBetter),b=r.find((e=>"control"===e.name.toLowerCase()))||r[0],C=i.find((e=>e.variant===b.id)),w=C?C[m]:0,S=r.map((e=>{const t=(i.find((t=>t.variant===e.id))||{variant:e.id})[m]||0,a=e.id===b.id;let r=0,n=0;a||0===w||(r=t-w,n=r/w*100);const s=!a&&Math.abs(n)>5;return{name:e.name,variantId:e.id,value:t,lift:r,liftPercent:n,isBaseline:a,isSignificant:s,isPositive:y?r>0:r<0}})),k=(e,t)=>{if(!t)return x.palette.text.secondary;return y&&e>0||!y&&e<0?x.palette.success.main:x.palette.error.main},A=({active:e,payload:t,label:r})=>{if(e&&t&&t.length){const e=t[0].payload;return a.jsxs(D,{sx:{p:1,border:`1px solid ${x.palette.divider}`},children:[a.jsx(p,{variant:"body2",sx:{fontWeight:"bold",mb:1},children:e.name}),a.jsxs(u,{sx:{display:"flex",justifyContent:"space-between",mb:.5},children:[a.jsxs(p,{variant:"body2",component:"span",color:"text.secondary",sx:{mr:2},children:[(null==g?void 0:g.name)||m,":"]}),a.jsx(p,{variant:"body2",component:"span",sx:{fontWeight:"medium"},children:f(e.value)})]}),!e.isBaseline&&a.jsxs(a.Fragment,{children:[a.jsxs(u,{sx:{display:"flex",justifyContent:"space-between",mb:.5},children:[a.jsx(p,{variant:"body2",component:"span",color:"text.secondary",sx:{mr:2},children:"Change vs Control:"}),a.jsxs(p,{variant:"body2",component:"span",sx:{fontWeight:"medium",color:k(e.liftPercent,e.isSignificant)},children:[e.liftPercent>=0?"+":"",e.liftPercent.toFixed(2),"%"]})]}),a.jsxs(u,{sx:{display:"flex",justifyContent:"space-between",mb:.5},children:[a.jsx(p,{variant:"body2",component:"span",color:"text.secondary",sx:{mr:2},children:"Significant:"}),a.jsx(p,{variant:"body2",component:"span",sx:{fontWeight:"medium"},children:e.isSignificant?"Yes":"No"})]})]})]})}return null};return a.jsx(D,{sx:{height:"100%"},children:a.jsxs(M,{sx:{height:"100%",display:"flex",flexDirection:"column"},children:[a.jsxs(u,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",mb:2},children:[a.jsxs(u,{children:[a.jsx(p,{variant:"h6",component:"div",gutterBottom:!0,children:e}),t&&a.jsx(p,{variant:"body2",color:"text.secondary",children:t})]}),a.jsx(u,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:n.map((e=>a.jsx(se,{label:e.name,color:e.key===m?"primary":"default",onClick:()=>d&&d(e.key),size:"small"},e.key)))})]}),a.jsxs(u,{sx:{flexGrow:1,width:"100%",height:"string"==typeof s?s:`${s}px`},children:[a.jsx(Xe,{width:"100%",height:"70%",children:a.jsxs(ot,{data:S,margin:{top:20,right:30,left:20,bottom:10},children:[a.jsx(Qe,{strokeDasharray:"3 3",stroke:x.palette.divider}),a.jsx(Ze,{dataKey:"name",tick:{fontSize:12},stroke:x.palette.text.secondary}),a.jsx(et,{tick:{fontSize:12},stroke:x.palette.text.secondary,tickFormatter:f}),a.jsx(tt,{content:a.jsx(A,{})}),a.jsx(lt,{dataKey:"value",fill:x.palette.primary.main,barSize:50,children:a.jsx(xt,{dataKey:"value",position:"top",formatter:f})})]})}),o&&a.jsxs(u,{sx:{mt:2},children:[a.jsxs(p,{variant:"subtitle2",gutterBottom:!0,children:["Relative Change vs Control (",b.name,")"]}),a.jsx(v,{container:!0,spacing:2,children:S.filter((e=>!e.isBaseline)).map((e=>a.jsx(v,{item:!0,xs:12,sm:6,md:4,children:a.jsxs(u,{sx:{display:"flex",alignItems:"center",p:1,border:`1px solid ${x.palette.divider}`,borderRadius:1,backgroundColor:x.palette.background.paper},children:[a.jsx(p,{variant:"body2",sx:{flexGrow:1},children:e.name}),a.jsxs(p,{variant:"body2",sx:{fontWeight:"bold",color:k(e.liftPercent,e.isSignificant)},children:[e.liftPercent>=0?"+":"",e.liftPercent.toFixed(2),"%",e.isSignificant&&a.jsx(u,{component:"span",sx:{display:"inline-block",width:8,height:8,borderRadius:"50%",backgroundColor:e.isPositive?x.palette.success.main:x.palette.error.main,ml:.5}})]})]})},e.variantId)))})]})]})]})})},Qt=({title:e,description:n,nodes:i,connections:s,height:o=500,onNodeClick:l})=>{const c=j(),d=r.useRef(null),[h,m]=r.useState(1),[g,f]=r.useState({x:0,y:0}),[y,v]=r.useState(!1),[b,C]=r.useState({x:0,y:0}),w=t.useMemo((()=>{const e=(()=>{const e=i.filter((e=>!s.some((t=>t.target===e.id)))).map((e=>e.id)),t={},a=new Set,r=(e,n)=>{if(a.has(e))return;a.add(e),t[e]=Math.max(n,t[e]||0);s.filter((t=>t.source===e)).forEach((e=>{r(e.target,n+1)}))};return e.forEach((e=>{r(e,0)})),t})(),t=Math.max(...Object.values(e)),a={};Object.entries(e).forEach((([e,t])=>{a[t]||(a[t]=[]),a[t].push(e)}));const r={};return Object.entries(a).forEach((([e,a])=>{const n=parseInt(e),i=a.length;a.forEach(((e,a)=>{r[e]={x:(a+.5)/i,y:n/(t>0?t:1)}}))})),r}),[i,s]),S=e=>{switch(e){case"entry":return c.palette.success.main;case"exit":return c.palette.error.main;case"page":return c.palette.primary.main;case"action":return c.palette.secondary.main;case"decision":return c.palette.warning.main;default:return c.palette.grey[500]}},k=e=>({backgroundColor:S(e.type),borderRadius:"page"===e.type?"4px":"50%",width:"page"===e.type?180:120,height:"page"===e.type?80:120,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",color:c.palette.getContrastText(S(e.type)),padding:2,cursor:l?"pointer":"default",border:`2px solid ${c.palette.background.paper}`,boxShadow:"0 2px 4px rgba(0,0,0,0.1)",transition:"transform 0.2s, box-shadow 0.2s",position:"absolute",transform:"translate(-50%, -50%)","&:hover":{transform:"translate(-50%, -50%) scale(1.05)",boxShadow:"0 4px 8px rgba(0,0,0,0.15)",zIndex:10}});return a.jsx(D,{sx:{height:"100%"},children:a.jsxs(M,{sx:{height:"100%",display:"flex",flexDirection:"column"},children:[a.jsxs(u,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[a.jsxs(u,{children:[a.jsx(p,{variant:"h6",component:"div",gutterBottom:!0,children:e}),n&&a.jsx(p,{variant:"body2",color:"text.secondary",children:n})]}),a.jsxs(u,{sx:{display:"flex",gap:1},children:[a.jsx(P,{size:"small",onClick:()=>{m((e=>Math.min(e+.1,2)))},title:"Zoom In",children:a.jsx(Z,{fontSize:"small"})}),a.jsx(P,{size:"small",onClick:()=>{m((e=>Math.max(e-.1,.5)))},title:"Zoom Out",children:a.jsx(ee,{fontSize:"small"})}),a.jsx(P,{size:"small",onClick:()=>{m(1),f({x:0,y:0})},title:"Reset View",children:a.jsx(ce,{fontSize:"small"})}),a.jsx(P,{size:"small",onClick:()=>{var e;const t=null==(e=d.current)?void 0:e.querySelector("svg");if(!t)return;const a=(new XMLSerializer).serializeToString(t),r=new Blob([a],{type:"image/svg+xml;charset=utf-8"}),n=URL.createObjectURL(r),i=document.createElement("a");i.href=n,i.download="user-journey-flow.svg",document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(n)},title:"Download SVG",children:a.jsx(de,{fontSize:"small"})})]})]}),a.jsx(x,{ref:d,sx:{flexGrow:1,width:"100%",height:"string"==typeof o?o:`${o}px`,overflow:"hidden",position:"relative",cursor:y?"grabbing":"grab",userSelect:"none"},onMouseDown:e=>{v(!0),C({x:e.clientX-g.x,y:e.clientY-g.y})},onMouseMove:e=>{y&&f({x:e.clientX-b.x,y:e.clientY-b.y})},onMouseUp:()=>{v(!1)},onMouseLeave:()=>{v(!1)},children:a.jsxs(u,{sx:{position:"absolute",width:"100%",height:"100%",top:0,left:0,transform:`translate(${g.x}px, ${g.y}px) scale(${h})`,transformOrigin:"center"},children:[a.jsxs("svg",{width:"100%",height:"100%",viewBox:"0 0 1000 1000",preserveAspectRatio:"xMidYMid meet",children:[s.map(((e,r)=>{const n=w[e.source],i=w[e.target];if(!n||!i)return null;const o=1e3*n.x,l=1e3*n.y,d=1e3*i.x,h=1e3*i.y,x=o+.7*(d-o),u=l,m=d-.7*(d-o),p=h,g=Math.max(...s.map((e=>e.value))),f=1+e.value/g*9,y=(o+d)/2,j=(l+h)/2-10;return a.jsxs(t.Fragment,{children:[a.jsx("path",{d:`M ${o} ${l} C ${x} ${u}, ${m} ${p}, ${d} ${h}`,fill:"none",stroke:c.palette.primary.main,strokeWidth:f,strokeOpacity:.6,markerEnd:"url(#arrowhead)"}),a.jsxs("text",{x:y,y:j,fontSize:"12",textAnchor:"middle",fill:c.palette.text.secondary,style:{fontFamily:c.typography.fontFamily,pointerEvents:"none"},children:[e.percentage.toFixed(1),"%"]})]},`connection-${r}`)})),a.jsx("defs",{children:a.jsx("marker",{id:"arrowhead",markerWidth:"10",markerHeight:"7",refX:"10",refY:"3.5",orient:"auto",children:a.jsx("polygon",{points:"0 0, 10 3.5, 0 7",fill:c.palette.primary.main})})})]}),i.map((e=>{const t=w[e.id];return t?a.jsxs(u,{sx:{...k(e),left:100*t.x+"%",top:100*t.y+"%"},onClick:()=>l&&l(e.id),children:[a.jsx(p,{variant:"body2",sx:{fontWeight:"bold",textAlign:"center"},children:e.name}),a.jsxs(p,{variant:"caption",sx:{textAlign:"center"},children:[e.count.toLocaleString()," users"]}),void 0!==e.conversionRate&&a.jsx(se,{label:`${e.conversionRate.toFixed(1)}% conv.`,size:"small",color:"success",sx:{fontSize:"0.625rem",mt:.5}}),void 0!==e.dropoffRate&&e.dropoffRate>0&&a.jsx(se,{label:`${e.dropoffRate.toFixed(1)}% drop`,size:"small",color:"error",sx:{fontSize:"0.625rem",mt:.5}})]},`node-${e.id}`):null}))]})}),a.jsx(u,{sx:{display:"flex",justifyContent:"center",gap:2,mt:2,flexWrap:"wrap"},children:["entry","page","action","decision","exit"].map((e=>a.jsxs(u,{sx:{display:"flex",alignItems:"center"},children:[a.jsx(u,{sx:{width:12,height:12,backgroundColor:S(e),borderRadius:"page"===e?"2px":"50%",mr:.5}}),a.jsx(p,{variant:"caption",color:"text.secondary",children:e.charAt(0).toUpperCase()+e.slice(1)})]},e)))})]})})},Zt=[{label:"Today",range:[new Date,new Date]},{label:"Yesterday",range:[pt(new Date,-1),pt(new Date,-1)]},{label:"Last 7 days",range:[pt(new Date,-6),new Date]},{label:"Last 30 days",range:[pt(new Date,-29),new Date]},{label:"This month",range:[new Date((new Date).getFullYear(),(new Date).getMonth(),1),new Date]},{label:"Last month",range:[new Date((new Date).getFullYear(),(new Date).getMonth()-1,1),new Date((new Date).getFullYear(),(new Date).getMonth(),0)]}],ea=({filterDefinitions:e,filters:n,onFiltersChange:i,savedFilters:s=[],onSaveFilter:o,onLoadFilter:l,onDeleteFilter:c,onExport:d,refreshInterval:h=0,onRefreshIntervalChange:m,isAutoRefreshEnabled:f=!1,onAutoRefreshToggle:y,isLoading:A=!1,onRefresh:I})=>{const R=j(),[T,$]=t.useState(!1),[z,F]=t.useState(""),[B,E]=t.useState(null),[L,W]=t.useState(null),O=Boolean(B),U=Boolean(L),V=(e,t)=>{i({...n,[e]:t})},K=e=>{const{id:t,name:i,type:s,options:o,defaultValue:l}=e,c=void 0!==n[t]?n[t]:l;switch(s){case"select":return a.jsxs(C,{fullWidth:!0,size:"small",children:[a.jsx(w,{id:`filter-${t}-label`,children:i}),a.jsxs(S,{labelId:`filter-${t}-label`,id:`filter-${t}`,value:c||"",label:i,onChange:e=>V(t,e.target.value),children:[a.jsx(k,{value:"",children:a.jsx("em",{children:"All"})}),null==o?void 0:o.map((e=>a.jsx(k,{value:e.id,children:e.label},e.id)))]})]});case"multi-select":return a.jsxs(C,{fullWidth:!0,size:"small",children:[a.jsx(w,{id:`filter-${t}-label`,children:i}),a.jsx(S,{labelId:`filter-${t}-label`,id:`filter-${t}`,multiple:!0,value:c||[],onChange:e=>V(t,e.target.value),input:a.jsx(ye,{label:i}),renderValue:e=>a.jsx(u,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:e.map((e=>{const t=null==o?void 0:o.find((t=>t.id===e));return a.jsx(se,{label:(null==t?void 0:t.label)||e,size:"small"},e)}))}),children:null==o?void 0:o.map((e=>a.jsx(k,{value:e.id,children:e.label},e.id)))})]});case"search":return a.jsx(fe,{multiple:!0,id:`filter-${t}`,options:o||[],getOptionLabel:e=>"string"==typeof e?e:e.label,value:c||[],onChange:(e,a)=>V(t,a),renderInput:e=>a.jsx(b,{...e,label:i,placeholder:i,size:"small"}),renderTags:(e,t)=>e.map(((e,a)=>{const n="string"==typeof e?e:e.label;return r.createElement(se,{...t({index:a}),key:a,label:n,size:"small"})})),size:"small"});case"toggle":return a.jsxs(u,{children:[a.jsx(p,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:i}),a.jsx(u,{sx:{display:"flex",gap:1},children:null==o?void 0:o.map((e=>a.jsx(se,{label:e.label,clickable:!0,color:c===e.id?"primary":"default",onClick:()=>V(t,c===e.id?null:e.id)},e.id)))})]});case"date-range":return a.jsxs(u,{children:[a.jsx(p,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:i}),a.jsx(ge,{value:c||[null,null],onChange:e=>V(t,e),slotProps:{textField:{size:"small",fullWidth:!0}}}),a.jsx(u,{sx:{display:"flex",flexWrap:"wrap",gap:.5,mt:1},children:Zt.map(((e,t)=>a.jsx(se,{label:e.label,size:"small",onClick:()=>{var t;2===(t=e.range).length&&gt(t[0])&&gt(t[1])&&V("dateRange",t)},sx:{fontSize:"0.75rem"}},t)))})]});default:return null}};return a.jsx(D,{sx:{mb:3},children:a.jsxs(M,{children:[a.jsxs(u,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[a.jsxs(u,{sx:{display:"flex",alignItems:"center"},children:[a.jsx(P,{onClick:()=>$(!T),color:T?"primary":"default",size:"small",sx:{mr:1},children:a.jsx(he,{})}),a.jsx(p,{variant:"subtitle1",component:"div",children:"Filters"}),Object.keys(n).length>0&&a.jsx(se,{label:Object.keys(n).length,size:"small",color:"primary",sx:{ml:1}})]}),a.jsxs(u,{sx:{display:"flex",gap:1},children:[o&&a.jsxs(a.Fragment,{children:[a.jsx(g,{startIcon:a.jsx(xe,{}),size:"small",onClick:e=>{E(e.currentTarget)},children:"Save"}),a.jsx(ue,{open:O,anchorEl:B,onClose:()=>E(null),anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},children:a.jsxs(x,{sx:{p:2,width:300},children:[a.jsx(p,{variant:"subtitle2",gutterBottom:!0,children:"Save Current Filters"}),a.jsx(b,{fullWidth:!0,size:"small",label:"Filter Name",value:z,onChange:e=>F(e.target.value),sx:{mb:2}}),a.jsx(g,{fullWidth:!0,variant:"contained",onClick:()=>{z.trim()&&o&&(o(z.trim()),F(""),E(null))},disabled:!z.trim(),children:"Save"})]})})]}),l&&s.length>0&&a.jsxs(a.Fragment,{children:[a.jsx(g,{size:"small",onClick:e=>{W(e.currentTarget)},children:"Load"}),a.jsx(ue,{open:U,anchorEl:L,onClose:()=>W(null),anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},children:a.jsxs(x,{sx:{p:2,width:300,maxHeight:400,overflow:"auto"},children:[a.jsx(p,{variant:"subtitle2",gutterBottom:!0,children:"Saved Filters"}),s.map((e=>a.jsxs(u,{sx:{p:1,mb:1,borderRadius:1,border:`1px solid ${R.palette.divider}`,display:"flex",alignItems:"center",cursor:"pointer","&:hover":{backgroundColor:R.palette.action.hover}},onClick:()=>{return t=e.id,void(l&&(l(t),W(null)));var t},children:[a.jsx(p,{variant:"body2",sx:{flex:1},children:e.name}),c&&a.jsx(P,{size:"small",onClick:t=>{return a=e.id,t.stopPropagation(),void(c&&c(a));var a},children:a.jsx(me,{fontSize:"small"})})]},e.id)))]})})]}),d&&a.jsx(g,{startIcon:a.jsx(de,{}),size:"small",onClick:d,children:"Export"}),I&&a.jsx(g,{startIcon:a.jsx(pe,{}),size:"small",onClick:I,disabled:A,children:"Refresh"})]})]}),m&&y&&a.jsxs(u,{sx:{display:"flex",alignItems:"center",gap:2,mb:2,p:1,borderRadius:1,backgroundColor:R.palette.action.hover},children:[a.jsx(se,{icon:a.jsx(pe,{}),label:f?"Auto refresh on":"Auto refresh off",color:f?"success":"default",onClick:y,variant:f?"filled":"outlined"}),f&&a.jsx(b,{label:"Interval (seconds)",type:"number",size:"small",value:h,onChange:e=>{const t=parseInt(e.target.value,10);m&&!isNaN(t)&&m(t)},InputProps:{inputProps:{min:5,max:3600}},sx:{width:150}})]}),T&&a.jsx(v,{container:!0,spacing:2,sx:{mt:1},children:e.map((e=>a.jsx(v,{item:!0,xs:12,sm:6,md:4,lg:3,children:K(e)},e.id)))}),!T&&Object.keys(n).length>0&&a.jsxs(u,{sx:{display:"flex",flexWrap:"wrap",gap:1},children:[Object.entries(n).map((([t,r])=>{var n;if(!r||Array.isArray(r)&&0===r.length)return null;const i=e.find((e=>e.id===t));if(!i)return null;let s;if("date-range"===i.type&&Array.isArray(r)&&2===r.length){const[e,t]=r;if(!gt(e)||!gt(t))return null;s=`${mt(e,"MMM d, yyyy")} - ${mt(t,"MMM d, yyyy")}`}else if(Array.isArray(r)){if(0===r.length)return null;if(i.options){s=r.map((e=>{var t;const a=null==(t=i.options)?void 0:t.find((t=>t.id===e));return(null==a?void 0:a.label)||e})).join(", ")}else s=r.join(", ")}else if("select"===i.type||"toggle"===i.type){const e=null==(n=i.options)?void 0:n.find((e=>e.id===r));s=(null==e?void 0:e.label)||r}else s=r.toString();return a.jsx(se,{label:`${i.name}: ${s}`,onDelete:()=>V(t,"multi-select"===i.type?[]:null),size:"small"},t)})),Object.keys(n).length>0&&a.jsx(se,{label:"Clear All",onClick:()=>i({}),size:"small",color:"error",variant:"outlined"})]})]})})},ta={small:{xs:12,sm:6,md:4,lg:3},medium:{xs:12,sm:12,md:6,lg:6},large:{xs:12,sm:12,md:12,lg:12}},aa=({availableWidgets:e,dashboard:t,isEditing:n,onAddWidget:i,onUpdateWidget:c,onRemoveWidget:d,onSaveDashboard:h,onUpdateLayout:x,data:m,isLoading:f=!1,onExport:y,onToggleEditMode:j})=>{var A,I;const[R,T]=r.useState(!1),[$,F]=r.useState(!1),[B,E]=r.useState(!1),[L,W]=r.useState(null),[O,U]=r.useState(t.name),[V,K]=r.useState(null),[_,N]=r.useState(null),[q,G]=r.useState(null),[J,X]=r.useState("grid"),Y=[...t.widgets].sort(((e,t)=>e.position-t.position)),Q=()=>{K(null)},Z=(e,t)=>{e.stopPropagation(),N(t),G(e.currentTarget)},ee=()=>{G(null)},te=()=>{T(!0),Q()},ae=(e,t)=>{L&&W({...L,options:{...L.options,[e]:t}})},re=t=>{const r=e.find((e=>e.type===t.type));if(!r)return null;const n=r.component,i=m[t.type]||{};return a.jsx(n,{...t.options,title:t.title,data:i,isLoading:f})};return a.jsxs(u,{sx:{position:"relative"},children:[a.jsxs(u,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3,position:"sticky",top:0,zIndex:10,backgroundColor:"background.default",py:1},children:[a.jsxs(u,{sx:{display:"flex",alignItems:"center"},children:[a.jsx(je,{sx:{mr:1}}),a.jsx(p,{variant:"h5",component:"h1",children:t.name})]}),a.jsxs(u,{sx:{display:"flex",alignItems:"center"},children:[n&&a.jsx(H,{title:"Display Mode",children:a.jsx(P,{size:"small",onClick:()=>X((e=>"grid"===e?"list":"grid")),children:"grid"===J?a.jsx(ve,{}):a.jsx(be,{})})}),a.jsx(H,{title:"Dashboard Settings",children:a.jsx(P,{onClick:e=>{K(e.currentTarget)},size:"small",children:a.jsx(ne,{})})}),a.jsxs(ie,{anchorEl:V,open:Boolean(V),onClose:Q,children:[a.jsxs(k,{onClick:()=>{j&&j(),Q()},children:[a.jsx(Ce,{fontSize:"small",sx:{mr:1}}),n?"Exit Edit Mode":"Edit Dashboard"]}),n&&a.jsxs(k,{onClick:te,children:[a.jsx(we,{fontSize:"small",sx:{mr:1}}),"Add Widget"]}),a.jsxs(k,{onClick:()=>{U(t.name),E(!0),Q()},children:[a.jsx(xe,{fontSize:"small",sx:{mr:1}}),"Save Dashboard"]}),y&&a.jsxs(k,{onClick:()=>{y&&y(),Q()},children:[a.jsx(de,{fontSize:"small",sx:{mr:1}}),"Export Dashboard"]})]})]})]}),n&&"list"===J?a.jsx(s,{onDragEnd:e=>{if(!e.destination||!x)return;const t=[...Y],[a]=t.splice(e.source.index,1);t.splice(e.destination.index,0,a);const r=t.map(((e,t)=>({...e,position:t})));x(r)},children:a.jsx(o,{droppableId:"widgets",children:e=>a.jsxs(u,{...e.droppableProps,ref:e.innerRef,children:[Y.map(((e,t)=>a.jsx(l,{draggableId:e.id,index:t,children:t=>a.jsx(u,{ref:t.innerRef,...t.draggableProps,sx:{mb:2},children:a.jsx(D,{children:a.jsx(M,{sx:{p:1},children:a.jsxs(u,{sx:{display:"flex",alignItems:"center"},children:[a.jsx(u,{...t.dragHandleProps,sx:{mr:1},children:a.jsx(Se,{})}),a.jsx(p,{variant:"subtitle1",sx:{flex:1},children:e.title}),a.jsx(p,{variant:"body2",color:"text.secondary",sx:{mr:2},children:e.size}),a.jsx(P,{size:"small",onClick:t=>Z(t,e.id),children:a.jsx(ne,{fontSize:"small"})})]})})})})},e.id))),e.placeholder]})})}):a.jsxs(v,{container:!0,spacing:3,children:[Y.map((e=>a.jsx(v,{item:!0,...ta[e.size],children:a.jsxs(u,{sx:{position:"relative",height:"100%"},children:[n&&a.jsx(u,{sx:{position:"absolute",top:8,right:8,zIndex:5,backgroundColor:"rgba(255,255,255,0.8)",borderRadius:1},children:a.jsx(P,{size:"small",onClick:t=>Z(t,e.id),children:a.jsx(ne,{fontSize:"small"})})}),re(e)]})},e.id))),n&&a.jsx(v,{item:!0,xs:12,sm:6,md:4,children:a.jsx(D,{sx:{height:200,display:"flex",alignItems:"center",justifyContent:"center",border:"2px dashed",borderColor:"divider",backgroundColor:"action.hover",cursor:"pointer"},onClick:te,children:a.jsxs(u,{sx:{textAlign:"center"},children:[a.jsx(we,{sx:{fontSize:40,color:"text.secondary",mb:1}}),a.jsx(p,{variant:"body1",color:"text.secondary",children:"Add Widget"})]})})})]}),a.jsxs(ie,{anchorEl:q,open:Boolean(q),onClose:ee,children:[a.jsxs(k,{onClick:()=>_&&(e=>{const a=t.widgets.find((t=>t.id===e));a&&(W(a),F(!0)),ee()})(_),children:[a.jsx(Ce,{fontSize:"small",sx:{mr:1}}),"Edit Widget"]}),a.jsxs(k,{onClick:()=>{return _&&(e=_,d&&d(e),void ee());var e},children:[a.jsx(me,{fontSize:"small",sx:{mr:1}}),"Remove Widget"]})]}),a.jsxs(oe,{open:R,onClose:()=>T(!1),maxWidth:"xs",fullWidth:!0,children:[a.jsx(ke,{children:"Add Widget"}),a.jsx(le,{dividers:!0,children:a.jsx(u,{sx:{display:"flex",flexDirection:"column",gap:2},children:e.map((r=>a.jsx(D,{sx:{cursor:"pointer","&:hover":{backgroundColor:"action.hover"}},onClick:()=>(a=>{if(i){const r=e.find((e=>e.type===a));if(r){const e={id:`widget-${Date.now()}`,type:a,title:r.title,size:r.defaultSize||"medium",position:t.widgets.length,options:r.defaultOptions||{}};i(e)}}T(!1)})(r.type),children:a.jsx(M,{children:a.jsxs(u,{sx:{display:"flex",alignItems:"center"},children:[r.icon&&a.jsx(u,{sx:{mr:2},children:r.icon}),a.jsxs(u,{children:[a.jsx(p,{variant:"subtitle1",children:r.title}),r.description&&a.jsx(p,{variant:"body2",color:"text.secondary",children:r.description})]})]})})},r.type)))})}),a.jsx(Ae,{children:a.jsx(g,{onClick:()=>T(!1),children:"Cancel"})})]}),a.jsxs(oe,{open:$,onClose:()=>F(!1),maxWidth:"sm",fullWidth:!0,children:[a.jsx(ke,{children:"Edit Widget"}),a.jsx(le,{dividers:!0,children:L&&a.jsxs(u,{sx:{display:"flex",flexDirection:"column",gap:3},children:[a.jsx(b,{label:"Widget Title",fullWidth:!0,value:L.title,onChange:e=>W({...L,title:e.target.value})}),a.jsxs(C,{fullWidth:!0,children:[a.jsx(w,{children:"Widget Size"}),a.jsxs(S,{value:L.size,label:"Widget Size",onChange:e=>W({...L,size:e.target.value}),children:[a.jsx(k,{value:"small",children:"Small (1/4 width)"}),a.jsx(k,{value:"medium",children:"Medium (1/2 width)"}),a.jsx(k,{value:"large",children:"Large (Full width)"})]})]}),a.jsx(z,{}),a.jsx(p,{variant:"subtitle1",children:"Widget Options"}),(null==(A=e.find((e=>e.type===L.type)))?void 0:A.defaultOptions)&&Object.entries((null==(I=e.find((e=>e.type===L.type)))?void 0:I.defaultOptions)||{}).map((([e,t])=>{const r=void 0!==L.options[e]?L.options[e]:t;return"boolean"==typeof r?a.jsxs(C,{fullWidth:!0,margin:"normal",children:[a.jsx(w,{children:e}),a.jsxs(S,{value:r?"true":"false",label:e,onChange:t=>ae(e,"true"===t.target.value),children:[a.jsx(k,{value:"true",children:"Yes"}),a.jsx(k,{value:"false",children:"No"})]})]},e):"number"==typeof r?a.jsx(b,{label:e,type:"number",fullWidth:!0,margin:"normal",value:r,onChange:t=>ae(e,Number(t.target.value))},e):Array.isArray(r)?a.jsxs(C,{fullWidth:!0,margin:"normal",children:[a.jsx(w,{children:e}),a.jsx(S,{multiple:!0,value:r,label:e,onChange:t=>ae(e,t.target.value),renderValue:e=>e.join(", "),children:t.map((e=>a.jsxs(k,{value:e,children:[a.jsx(Ie,{checked:r.indexOf(e)>-1}),a.jsx(De,{primary:e})]},e)))})]},e):a.jsx(b,{label:e,fullWidth:!0,margin:"normal",value:r,onChange:t=>ae(e,t.target.value)},e)}))]})}),a.jsxs(Ae,{children:[a.jsx(g,{onClick:()=>F(!1),children:"Cancel"}),a.jsx(g,{onClick:()=>{L&&c&&c(L.id,{title:L.title,size:L.size,options:L.options}),F(!1),W(null)},variant:"contained",children:"Save Changes"})]})]}),a.jsxs(oe,{open:B,onClose:()=>E(!1),maxWidth:"sm",fullWidth:!0,children:[a.jsx(ke,{children:"Save Dashboard"}),a.jsx(le,{children:a.jsx(b,{autoFocus:!0,margin:"dense",label:"Dashboard Name",fullWidth:!0,value:O,onChange:e=>U(e.target.value)})}),a.jsxs(Ae,{children:[a.jsx(g,{onClick:()=>E(!1),children:"Cancel"}),a.jsx(g,{onClick:()=>{h&&O.trim()&&h(O.trim()),E(!1)},variant:"contained",children:"Save"})]})]})]})},ra=({insights:e,title:t="Automated Insights",description:n="AI-powered analysis of your metrics",isLoading:i=!1,onInsightSave:s,onRefresh:o,onCreateAlert:l,maxItems:c=5,showCategories:d})=>{const h=j(),[x,m]=r.useState(!1),[y,v]=r.useState(c),b=e||[],C=d&&Array.isArray(d)&&b.length>0?b.filter((e=>d.includes(e.category))):b,w=e=>{if(!e)return{icon:null,color:h.palette.text.secondary};switch(e){case"up":return{icon:a.jsx(Oe,{fontSize:"small"}),color:h.palette.success.main};case"down":return{icon:a.jsx(We,{fontSize:"small"}),color:h.palette.error.main};default:return{icon:a.jsx(Le,{fontSize:"small"}),color:h.palette.warning.main}}},S=e=>{const t=new Date(e);return new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(t)};return a.jsxs(D,{sx:{height:"100%",display:"flex",flexDirection:"column"},children:[a.jsxs(M,{sx:{pb:1},children:[a.jsxs(u,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[a.jsxs(u,{sx:{display:"flex",alignItems:"center"},children:[a.jsx(Re,{sx:{mr:1,color:h.palette.warning.main}}),a.jsx(p,{variant:"h6",component:"div",children:t})]}),o&&a.jsx(H,{title:"Refresh Insights",children:a.jsx(P,{size:"small",onClick:o,disabled:i,children:a.jsx(f,{fontSize:"small"})})})]}),n&&a.jsx(p,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:n})]}),i?a.jsx(u,{sx:{p:2},children:[...Array(3)].map(((e,t)=>a.jsxs(u,{sx:{mb:2},children:[a.jsx(Me,{variant:"rectangular",height:20,width:"80%",sx:{mb:1}}),a.jsx(Me,{variant:"rectangular",height:15,width:"60%"}),a.jsxs(u,{sx:{display:"flex",gap:1,mt:1},children:[a.jsx(Me,{variant:"rectangular",height:24,width:80}),a.jsx(Me,{variant:"rectangular",height:24,width:60})]}),a.jsx(Me,{variant:"rectangular",height:1,sx:{my:2}})]},t)))}):a.jsxs(a.Fragment,{children:[a.jsx(u,{sx:{px:2,py:0,flexGrow:1,overflow:"auto"},children:0===C.length?a.jsxs(u,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",py:4},children:[a.jsx(Re,{sx:{fontSize:40,color:h.palette.action.disabled,mb:2}}),a.jsx(p,{variant:"body1",color:"text.secondary",align:"center",children:"No insights available."}),a.jsx(p,{variant:"body2",color:"text.secondary",align:"center",children:"Insights will appear here once there's enough data to analyze."})]}):C.slice(0,y).map(((e,t)=>{const r=(e=>{switch(e){case"performance":return{label:"Performance",color:h.palette.primary.main,icon:"📊"};case"anomaly":return{label:"Anomaly",color:h.palette.error.main,icon:"⚠️"};case"trend":return{label:"Trend",color:h.palette.info.main,icon:"📈"};case"opportunity":return{label:"Opportunity",color:h.palette.success.main,icon:"💡"};case"prediction":return{label:"Prediction",color:h.palette.secondary.main,icon:"🔮"};default:return{label:e,color:h.palette.grey[500],icon:"ℹ️"}}})(e.category),n=(e=>{switch(e){case"high":return{label:"High",color:h.palette.error.main};case"medium":return{label:"Medium",color:h.palette.warning.main};default:return{label:"Low",color:h.palette.success.main}}})(e.severity);return a.jsxs(Te,{expanded:x===e.id,onChange:(i=e.id,(e,t)=>{m(!!t&&i)}),elevation:0,disableGutters:!0,sx:{"&:before":{display:"none"},border:x===e.id?`1px solid ${h.palette.divider}`:"none",mb:2,backgroundColor:e.isNew?yt(h.palette.primary.light,.1):"transparent"},children:[a.jsx($e,{expandIcon:a.jsx(ze,{}),"aria-controls":`insight-${e.id}-content`,id:`insight-${e.id}-header`,sx:{px:1},children:a.jsxs(u,{sx:{display:"flex",flexDirection:"column",flex:1,mr:2},children:[a.jsxs(u,{sx:{display:"flex",alignItems:"center",mb:.5},children:[a.jsx(p,{variant:"subtitle1",component:"div",sx:{fontWeight:e.isNew?"bold":"medium",mr:1},children:e.title}),e.isNew&&a.jsx(se,{label:"New",size:"small",color:"primary",sx:{height:20,fontSize:"0.6875rem"}})]}),a.jsx(p,{variant:"body2",color:"text.secondary",sx:{mb:1},children:e.description.length>120?`${e.description.substring(0,120)}...`:e.description}),a.jsxs(u,{sx:{display:"flex",flexWrap:"wrap",gap:1},children:[a.jsx(se,{icon:a.jsx(u,{component:"span",sx:{mr:-.5},children:r.icon}),label:r.label,size:"small",sx:{backgroundColor:yt(r.color,.1),color:r.color,fontWeight:"medium",height:24}}),a.jsx(se,{label:`Priority: ${n.label}`,size:"small",sx:{backgroundColor:yt(n.color,.1),color:n.color,fontWeight:"medium",height:24}}),e.trend&&a.jsx(se,{icon:w(e.trend).icon||void 0,label:e.percent?`${e.percent>0?"+":""}${e.percent}%`:"",size:"small",sx:{backgroundColor:yt(w(e.trend).color,.1),color:w(e.trend).color,fontWeight:"medium",height:24}})]})]})}),a.jsxs(Pe,{sx:{px:1,pb:2},children:[a.jsx(p,{variant:"body2",paragraph:!0,children:e.description}),e.metrics&&e.metrics.length>0&&a.jsxs(u,{sx:{mt:2,mb:3},children:[a.jsx(p,{variant:"subtitle2",gutterBottom:!0,children:"Key Metrics"}),a.jsx(u,{sx:{display:"flex",flexWrap:"wrap",gap:2},children:e.metrics.map(((e,t)=>a.jsx(D,{variant:"outlined",sx:{minWidth:150,flex:"1 0 auto",maxWidth:200},children:a.jsxs(M,{sx:{p:1.5,"&:last-child":{pb:1.5}},children:[a.jsx(p,{variant:"caption",color:"text.secondary",children:e.name}),a.jsxs(u,{sx:{display:"flex",alignItems:"baseline"},children:[a.jsx(p,{variant:"h6",component:"div",sx:{mr:1},children:e.value}),e.change&&a.jsxs(u,{sx:{display:"flex",alignItems:"center",color:w(e.trend).color},children:[w(e.trend).icon,a.jsxs(p,{variant:"caption",sx:{ml:.5},children:[e.change>0?"+":"",e.change,"%"]})]})]})]})},t)))})]}),a.jsxs(u,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mt:2,pt:2,borderTop:`1px solid ${h.palette.divider}`},children:[a.jsxs(p,{variant:"caption",color:"text.secondary",children:["Generated ",S(e.createdAt)]}),a.jsxs(u,{sx:{display:"flex",gap:1},children:[l&&a.jsx(H,{title:"Create Alert",children:a.jsx(P,{size:"small",onClick:()=>l(e.id),children:a.jsx(Fe,{fontSize:"small"})})}),s&&a.jsx(H,{title:e.isSaved?"Remove Bookmark":"Bookmark",children:a.jsx(P,{size:"small",onClick:()=>s(e.id,!e.isSaved),children:e.isSaved?a.jsx(Be,{fontSize:"small",color:"primary"}):a.jsx(Ee,{fontSize:"small"})})})]})]})]})]},e.id);var i}))}),C.length>y&&a.jsx(u,{sx:{p:2,textAlign:"center"},children:a.jsx(g,{onClick:()=>{v((e=>e+5))},size:"small",children:"Load More Insights"})})]})]})},na=({title:e,description:t,trends:r,patterns:n=[],timeFrame:i="Last 30 days",isLoading:s=!1})=>{const o=j(),l=e=>{const{changeType:t,isPositive:r}=e;return"increase"===t?a.jsx(Oe,{sx:{color:r?o.palette.success.main:o.palette.error.main,fontSize:"1.25rem",verticalAlign:"middle"}}):"decrease"===t?a.jsx(We,{sx:{color:r?o.palette.success.main:o.palette.error.main,fontSize:"1.25rem",verticalAlign:"middle"}}):null},c=(e,t)=>{let a=e.toLocaleString();return t&&(a+=t),a},d=e=>{switch(e.patternType){case"spike":return a.jsx(Oe,{sx:{color:o.palette.warning.main}});case"drop":return a.jsx(We,{sx:{color:o.palette.error.main}});case"anomaly":return a.jsx(_e,{sx:{color:o.palette.error.main}});case"seasonal":return a.jsx(J,{sx:{color:o.palette.info.main}});case"cyclical":return a.jsx(J,{sx:{color:o.palette.primary.main}});case"trend":return a.jsx(Oe,{sx:{color:o.palette.success.main}});default:return a.jsx(Ke,{sx:{color:o.palette.text.secondary}})}};return a.jsx(D,{sx:{height:"100%"},children:a.jsxs(M,{sx:{height:"100%",display:"flex",flexDirection:"column"},children:[a.jsxs(u,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",mb:2},children:[a.jsxs(u,{children:[a.jsx(p,{variant:"h6",component:"div",gutterBottom:!0,children:e}),t&&a.jsx(p,{variant:"body2",color:"text.secondary",children:t})]}),a.jsx(se,{label:i,size:"small",color:"primary",variant:"outlined"})]}),s?a.jsx(u,{sx:{display:"flex",justifyContent:"center",alignItems:"center",flexGrow:1},children:a.jsx(A,{size:40})}):a.jsxs(u,{sx:{flexGrow:1,overflow:"auto"},children:[a.jsx(p,{variant:"subtitle2",gutterBottom:!0,sx:{fontWeight:"medium"},children:"Key Metrics"}),a.jsx(v,{container:!0,spacing:2,children:r.map(((e,t)=>a.jsx(v,{item:!0,xs:12,sm:6,children:a.jsxs(u,{sx:{p:2,borderRadius:1,bgcolor:o.palette.background.paper,border:`1px solid ${o.palette.divider}`,boxShadow:e.isCritical?`0 0 0 2px ${o.palette.error.main}`:"none",height:"100%"},children:[a.jsx(p,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:e.metric}),a.jsxs(u,{sx:{display:"flex",alignItems:"baseline"},children:[a.jsx(p,{variant:"h5",component:"div",sx:{mr:1,fontWeight:"medium"},children:c(e.currentValue,e.unit)}),a.jsxs(u,{sx:{display:"flex",alignItems:"center",color:e.isPositive?o.palette.success.main:o.palette.error.main},children:[l(e),a.jsxs(p,{variant:"body2",component:"span",sx:{ml:.5},children:[e.changePercent>0?"+":"",e.changePercent.toFixed(1),"%"]})]})]}),a.jsxs(u,{sx:{mt:1,display:"flex",alignItems:"center"},children:[a.jsxs(p,{variant:"caption",color:"text.secondary",sx:{mr:1},children:["Previously: ",c(e.previousValue,e.unit)]}),e.isCritical&&a.jsx(se,{label:"Needs Attention",size:"small",color:"error",sx:{height:20,fontSize:"0.625rem"}})]}),e.notes&&a.jsx(p,{variant:"caption",color:"text.secondary",sx:{display:"block",mt:1},children:e.notes})]})},t)))}),n.length>0&&a.jsxs(a.Fragment,{children:[a.jsx(z,{sx:{my:3}}),a.jsx(p,{variant:"subtitle2",gutterBottom:!0,sx:{fontWeight:"medium"},children:"Detected Patterns"}),a.jsx(u,{sx:{display:"flex",flexDirection:"column",gap:2},children:n.map(((e,t)=>a.jsxs(u,{sx:{p:2,borderRadius:1,border:`1px solid ${o.palette.divider}`,bgcolor:o.palette.background.paper},children:[a.jsxs(u,{sx:{display:"flex",alignItems:"center",mb:1},children:[a.jsx(u,{sx:{mr:2},children:d(e)}),a.jsxs(u,{sx:{flexGrow:1},children:[a.jsxs(p,{variant:"subtitle2",children:[e.patternType.charAt(0).toUpperCase()+e.patternType.slice(1)," detected in ",e.metric]}),a.jsx(p,{variant:"body2",color:"text.secondary",children:e.description})]}),a.jsx(se,{label:`${e.confidence}% confidence`,size:"small",color:e.confidence>80?"success":"warning",sx:{ml:2}})]}),a.jsx(Ue,{variant:"determinate",value:e.confidence,sx:{height:4,borderRadius:2,bgcolor:o.palette.action.hover,".MuiLinearProgress-bar":{bgcolor:e.confidence>80?o.palette.success.main:o.palette.warning.main}}}),e.suggestion&&a.jsxs(u,{sx:{mt:2,display:"flex",alignItems:"center"},children:[a.jsx(Ve,{sx:{color:o.palette.success.main,fontSize:"1rem",mr:1}}),a.jsx(p,{variant:"body2",children:e.suggestion})]})]},t)))})]})]})]})})},ia=({title:e,description:t,comparisonItems:r,baselinePeriod:n,currentPeriod:i,isLoading:s=!1,showGoals:o=!0})=>{const l=j(),c=e=>{const{changePercent:t,isPositive:r}=e;return Math.abs(t)<.5?a.jsx(Le,{sx:{color:l.palette.warning.main,fontSize:"1.25rem"}}):t>0?a.jsx(Oe,{sx:{color:r?l.palette.success.main:l.palette.error.main,fontSize:"1.25rem"}}):a.jsx(We,{sx:{color:r?l.palette.success.main:l.palette.error.main,fontSize:"1.25rem"}})},d=(e,t)=>{let a="";return a=e>=1e6?`${(e/1e6).toFixed(1)}M`:e>=1e3?`${(e/1e3).toFixed(1)}K`:e.toLocaleString(),t&&(a+=t),a};return a.jsx(D,{sx:{height:"100%"},children:a.jsxs(M,{sx:{height:"100%",display:"flex",flexDirection:"column"},children:[a.jsxs(u,{sx:{mb:3},children:[a.jsx(p,{variant:"h6",component:"div",gutterBottom:!0,children:e}),t&&a.jsx(p,{variant:"body2",color:"text.secondary",children:t})]}),s?a.jsx(u,{sx:{display:"flex",justifyContent:"center",alignItems:"center",flexGrow:1},children:a.jsx(A,{size:40})}):a.jsxs(u,{sx:{flexGrow:1,overflow:"auto"},children:[a.jsxs(u,{sx:{display:"flex",justifyContent:"space-between",mb:3},children:[a.jsxs(u,{sx:{display:"flex",alignItems:"center",width:"40%",justifyContent:"center"},children:[a.jsx(Ne,{sx:{bgcolor:l.palette.grey[200],color:l.palette.text.secondary,width:32,height:32,mr:1},children:"A"}),a.jsx(p,{variant:"subtitle2",children:n})]}),a.jsx(qe,{sx:{color:l.palette.action.active}}),a.jsxs(u,{sx:{display:"flex",alignItems:"center",width:"40%",justifyContent:"center"},children:[a.jsx(Ne,{sx:{bgcolor:l.palette.primary.main,width:32,height:32,mr:1},children:"B"}),a.jsx(p,{variant:"subtitle2",children:i})]})]}),a.jsx(z,{sx:{mb:3}}),r.map(((e,t)=>a.jsxs(u,{sx:{mb:3},children:[a.jsxs(u,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:1},children:[a.jsx(p,{variant:"subtitle2",children:e.metric}),a.jsxs(u,{sx:{display:"flex",alignItems:"center"},children:[c(e),a.jsxs(p,{variant:"body2",sx:{ml:.5,color:e.isPositive?l.palette.success.main:l.palette.error.main,fontWeight:"medium"},children:[e.changePercent>0?"+":"",e.changePercent.toFixed(1),"%"]})]})]}),a.jsx(x,{variant:"outlined",sx:{p:2,mb:1},children:a.jsxs(v,{container:!0,spacing:1,children:[a.jsxs(v,{item:!0,xs:5,children:[a.jsx(p,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:e.baseline.label}),a.jsx(p,{variant:"h6",children:d(e.baseline.value,e.unit)})]}),a.jsx(v,{item:!0,xs:2,sx:{display:"flex",justifyContent:"center",alignItems:"center"},children:a.jsx(qe,{sx:{color:l.palette.action.active,fontSize:"2rem"}})}),a.jsxs(v,{item:!0,xs:5,children:[a.jsx(p,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:e.current.label}),a.jsx(p,{variant:"h6",sx:{fontWeight:"bold",color:e.isPositive?e.changePercent>0?l.palette.success.main:l.palette.error.main:e.changePercent<0?l.palette.success.main:l.palette.error.main},children:d(e.current.value,e.unit)})]})]})}),o&&void 0!==e.target&&a.jsxs(u,{sx:{mt:1},children:[a.jsxs(u,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:.5},children:[a.jsxs(p,{variant:"caption",color:"text.secondary",children:["Goal: ",d(e.target,e.unit)]}),a.jsxs(u,{sx:{display:"flex",alignItems:"center"},children:[void 0!==e.goalCompletion&&e.goalCompletion>=100?a.jsx(Ve,{sx:{color:l.palette.success.main,fontSize:"1rem",mr:.5}}):a.jsx(Ge,{sx:{color:l.palette.warning.main,fontSize:"1rem",mr:.5}}),a.jsx(p,{variant:"caption",sx:{fontWeight:"medium",color:void 0!==e.goalCompletion&&e.goalCompletion>=100?l.palette.success.main:l.palette.warning.main},children:void 0!==e.goalCompletion?`${Math.min(e.goalCompletion,100).toFixed(0)}% Complete`:"No data"})]})]}),void 0!==e.goalCompletion&&a.jsx(Ue,{variant:"determinate",value:Math.min(e.goalCompletion,100),sx:{height:4,borderRadius:2,bgcolor:l.palette.action.hover,".MuiLinearProgress-bar":{bgcolor:e.goalCompletion>=100?l.palette.success.main:e.goalCompletion>=70?l.palette.warning.main:l.palette.error.main}}})]}),e.notes&&a.jsx(p,{variant:"caption",color:"text.secondary",sx:{display:"block",mt:1},children:e.notes})]},t)))]})]})})},sa=e=>{const{children:t,value:r,index:n,...i}=e;return a.jsx("div",{role:"tabpanel",hidden:r!==n,id:`ux-analytics-tabpanel-${n}`,"aria-labelledby":`ux-analytics-tab-${n}`,...i,style:{height:"100%"},children:r===n&&a.jsx(u,{sx:{pt:3,height:"100%"},children:t})})},oa=[{id:"dateRange",name:"Date Range",type:"date-range",defaultValue:[ft(new Date,30),new Date]},{id:"userType",name:"User Type",type:"select",options:[{id:"all",label:"All Users"},{id:"authenticated",label:"Authenticated Users"},{id:"anonymous",label:"Anonymous Users"}],defaultValue:"all"},{id:"features",name:"Features",type:"multi-select",options:[{id:"aiAssistant",label:"AI Assistant"},{id:"collaboration",label:"Collaboration"},{id:"contentCreation",label:"Content Creation"},{id:"dashboard",label:"Dashboard"},{id:"analytics",label:"Analytics"}]},{id:"platformType",name:"Platform",type:"toggle",options:[{id:"all",label:"All"},{id:"web",label:"Web"},{id:"mobile",label:"Mobile"}],defaultValue:"all"}],la=[{id:"last-30-days",name:"Last 30 Days - All Users",filters:{dateRange:[ft(new Date,30),new Date],userType:"all"}},{id:"ai-assistant-usage",name:"AI Assistant Usage - Last 7 Days",filters:{dateRange:[ft(new Date,7),new Date],features:["aiAssistant"],userType:"authenticated"}},{id:"collaboration-metrics",name:"Collaboration Metrics - Last 14 Days",filters:{dateRange:[ft(new Date,14),new Date],features:["collaboration"],platformType:"web"}}],ca=[{type:"featureUsage",title:"Feature Usage Trends",description:"Track usage trends across different features",component:Ht,defaultSize:"medium",defaultOptions:{dataKeys:["aiAssistant","collaboration","contentCreation","dashboard"],formatValue:e=>`${e}`,yAxisLabel:"Usage Count",showControls:!0}},{type:"userDistribution",title:"User Type Distribution",description:"Breakdown of usage by user type",component:Jt,defaultSize:"small",defaultOptions:{showLegend:!0,formatValue:e=>`${e.toLocaleString()} users`}},{type:"aiAssistantMetrics",title:"AI Assistant Effectiveness",description:"Track AI suggestion acceptance rates and quality",component:Ht,defaultSize:"medium",defaultOptions:{dataKeys:["acceptanceRate","qualityScore"],formatValue:e=>`${e.toFixed(1)}%`,yAxisLabel:"Rate",showControls:!0}},{type:"featureHeatmap",title:"Feature Usage Heatmap",description:"Usage patterns by time of day and day of week",component:Xt,defaultSize:"medium",defaultOptions:{formatValue:e=>`${e}`,colorScale:["#e0f7fa","#006064"]}},{type:"userJourney",title:"User Journey Flow",description:"Visualize common user paths through the application",component:Qt,defaultSize:"large",defaultOptions:{}},{type:"abTestResults",title:"A/B Test Results",description:"Compare performance of different UX variants",component:Yt,defaultSize:"medium",defaultOptions:{showRelativeChange:!0}},{type:"uxInsights",title:"UX Insights",description:"Automated insights and recommendations",component:ra,defaultSize:"medium",defaultOptions:{showCategories:["performance","opportunity"]}},{type:"trendAnalysis",title:"UX Trend Analysis",description:"Automatically detected trends and patterns",component:na,defaultSize:"medium",defaultOptions:{trends:[{metric:"Collaboration Feature Usage",currentValue:3240,previousValue:2150,changePercent:50.7,changeType:"increase",isPositive:!0},{metric:"WebSocket Error Rate",currentValue:.8,previousValue:2.3,changePercent:-65.2,changeType:"decrease",isPositive:!0,unit:"%"},{metric:"Mobile Session Duration",currentValue:432,previousValue:520,changePercent:-16.9,changeType:"decrease",isPositive:!1,isCritical:!0,unit:"s"}],patterns:[{patternType:"seasonal",description:"Weekly pattern detected with higher usage on Wednesdays and Thursdays",confidence:93,metric:"Daily Active Users",suggestion:"Consider scheduling feature releases on Mondays to maximize weekly exposure"},{patternType:"anomaly",description:"Unexpected drop in collaboration session duration on mobile devices",confidence:87,metric:"Mobile Collaboration Time",suggestion:"Investigate mobile interface issues in collaborative editing"}]}},{type:"periodComparison",title:"Period Comparison",description:"Compare metrics between different time periods",component:ia,defaultSize:"medium",defaultOptions:{baselinePeriod:"Previous Month",currentPeriod:"Current Month",comparisonItems:[{metric:"User Engagement",baseline:{value:6320,label:"Previous"},current:{value:8150,label:"Current"},changePercent:28.96,isPositive:!0,target:9e3,goalCompletion:90.5},{metric:"Average Session Duration",baseline:{value:720,label:"Previous"},current:{value:852,label:"Current"},changePercent:18.33,isPositive:!0,unit:"s",target:900,goalCompletion:94.7},{metric:"AI Suggestions Accepted",baseline:{value:62.4,label:"Previous"},current:{value:75.8,label:"Current"},changePercent:21.47,isPositive:!0,unit:"%",target:80,goalCompletion:94.75}]}}],da={id:"default-ux-dashboard",name:"UX Analytics Dashboard",widgets:[{id:"widget-1",type:"featureUsage",title:"Feature Usage Trends",size:"medium",position:0,options:{dataKeys:["aiAssistant","collaboration","contentCreation","dashboard"],formatValue:e=>`${e}`,yAxisLabel:"Usage Count"}},{id:"widget-2",type:"userDistribution",title:"User Type Distribution",size:"small",position:1,options:{showLegend:!0,formatValue:e=>`${e.toLocaleString()} users`}},{id:"widget-3",type:"aiAssistantMetrics",title:"AI Assistant Effectiveness",size:"medium",position:2,options:{dataKeys:["acceptanceRate","qualityScore"],formatValue:e=>`${e.toFixed(1)}%`,yAxisLabel:"Rate"}},{id:"widget-4",type:"abTestResults",title:"A/B Test Results",size:"medium",position:3,options:{showRelativeChange:!0}},{id:"widget-5",type:"uxInsights",title:"UX Insights",size:"medium",position:4,options:{showCategories:["performance","opportunity"]}}]},ha=()=>{var e,t,n,i,s,o,l,h,x,m,f,y,b,C,w,S,k,R,z,P,F,B,E,L,W,O,U,V,K,_,N,q,G,H,J,X,Y,Q,Z,ee,te,ae,re,ne,ie,se,oe,le,ce,de,he;const xe=j(),ue=c(),me=r.useRef(null),[pe,ge]=r.useState(0),[fe,ye]=r.useState({dateRange:[ft(new Date,30),new Date],userType:"all"}),[je,ve]=r.useState(da),[be,Ce]=r.useState(!1),[we,Se]=r.useState(0),[ke,Ae]=r.useState(!1),[Ie,De]=r.useState({open:!1,message:"",severity:"success"}),[Re,Me]=r.useState("conversionRate"),{getFeatureUsageMetrics:Te,getAIAssistantMetrics:$e,getWebSocketMetrics:ze,getUserJourneys:Pe,getABTestResults:Fe,getUXInsights:Be}=Tt(),Ee=e=>mt(e,"yyyy-MM-dd"),Le=r.useCallback((()=>{const e=fe.dateRange;return e&&e[0]&&e[1]?{startDate:Ee(e[0]),endDate:Ee(e[1])}:{startDate:Ee(ft(new Date,30)),endDate:Ee(new Date)}}),[fe.dateRange]),We=r.useCallback((()=>{const{startDate:e,endDate:t}=Le();return{startDate:e,endDate:t,userType:fe.userType||"all",features:Array.isArray(fe.features)?fe.features.join(","):void 0,platformType:"all"!==fe.platformType?fe.platformType:void 0}}),[fe,Le]),Oe=d(["featureUsage",We()],(()=>Te(We())),{refetchInterval:!!ke&&1e3*we,keepPreviousData:!0}),Ue=d(["aiAssistant",We()],(()=>$e(We())),{refetchInterval:!!ke&&1e3*we,keepPreviousData:!0}),Ve=d(["websocketMetrics",We()],(()=>ze(We())),{refetchInterval:!!ke&&1e3*we,keepPreviousData:!0}),Ke=d(["userJourneys",We()],(()=>Pe(We())),{refetchInterval:!!ke&&1e3*we,keepPreviousData:!0}),_e=d(["abTestResults",We()],(()=>Fe(We())),{refetchInterval:!!ke&&1e3*we,keepPreviousData:!0}),Ne=d(["uxInsights",We()],(()=>Be(We())),{refetchInterval:!!ke&&1e3*we,keepPreviousData:!0}),qe=Oe.isLoading||Ue.isLoading||Ve.isLoading||Ke.isLoading||_e.isLoading||Ne.isLoading,Ge={featureUsage:(null==(e=Oe.data)?void 0:e.dailyUsage)||[],userDistribution:(null==(t=Oe.data)?void 0:t.userTypeDistribution)||[],aiAssistantMetrics:(null==(n=Ue.data)?void 0:n.dailyMetrics)||[],featureHeatmap:(null==(i=Oe.data)?void 0:i.heatmapData)||[],userJourney:Ke.data||{nodes:[],connections:[]},abTestResults:_e.data||{variants:[],metrics:[],results:[]},uxInsights:Ne.data||[]},Je=()=>{me.current&&(async(e,t,a,r="landscape")=>{try{const n=document.getElementById(e);if(!n)throw new Error(`Element with ID ${e} not found`);const i=await jt(n,{scale:2,backgroundColor:"#FFFFFF",logging:!1}),s=i.toDataURL("image/png"),o=new vt({orientation:r,unit:"mm",format:"a4"}),l="portrait"===r?210:297,c="portrait"===r?297:210,d=i.width,h=i.height,x=.9*Math.min(l/d,c/h),u=(l-d*x)/2,m=a?30:10;a&&(o.setFontSize(18),o.text(a,l/2,20,{align:"center"})),o.addImage(s,"PNG",u,m,d*x,h*x);const p=(new Date).toLocaleString();o.setFontSize(10),o.setTextColor(100,100,100),o.text(`Generated on ${p}`,l-15,c-10,{align:"right"}),o.save(`${t}.pdf`)}catch(n){throw n}})("dashboard-container","ux-analytics-dashboard",je.name,"landscape").then((()=>{De({open:!0,message:"Dashboard exported successfully",severity:"success"})})).catch((e=>{De({open:!0,message:`Error exporting dashboard: ${e.message}`,severity:"error"})}))},Xe=()=>{De((e=>({...e,open:!1})))};return a.jsxs(u,{sx:{height:"100%",display:"flex",flexDirection:"column"},children:[a.jsx(u,{sx:{borderBottom:1,borderColor:"divider"},children:a.jsxs(T,{value:pe,onChange:(e,t)=>{ge(t)},variant:"scrollable",scrollButtons:"auto",children:[a.jsx($,{label:"Dashboard"}),a.jsx($,{label:"Feature Usage"}),a.jsx($,{label:"AI Assistant"}),a.jsx($,{label:"WebSocket Metrics"}),a.jsx($,{label:"User Journeys"}),a.jsx($,{label:"A/B Testing"}),a.jsx($,{label:"Automated Insights"})]})}),a.jsx(ea,{filterDefinitions:oa,filters:fe,onFiltersChange:e=>{ye(e)},savedFilters:la,onSaveFilter:e=>{De({open:!0,message:`Filter saved as: ${e}`,severity:"success"})},onLoadFilter:e=>{const t=la.find((t=>t.id===e));if(t){const e=JSON.parse(JSON.stringify(t.filters));"platform"in e&&(e.platformType=e.platform,"string"==typeof e.platformType&&["all","web","mobile"].includes(e.platformType)||(e.platformType="all"),delete e.platform),ye(e),De({open:!0,message:`Loaded filter: ${t.name}`,severity:"success"})}},onExport:Je,refreshInterval:we,onRefreshIntervalChange:e=>{Se(e)},isAutoRefreshEnabled:ke,onAutoRefreshToggle:()=>{Ae((e=>!e))},isLoading:qe,onRefresh:()=>{ue.invalidateQueries(["featureUsage"]),ue.invalidateQueries(["aiAssistant"]),ue.invalidateQueries(["websocketMetrics"]),ue.invalidateQueries(["userJourneys"]),ue.invalidateQueries(["abTestResults"]),ue.invalidateQueries(["uxInsights"])}}),a.jsxs(u,{sx:{flexGrow:1,overflow:"auto"},children:[a.jsxs(sa,{value:pe,index:0,children:[a.jsxs(v,{container:!0,spacing:3,sx:{mb:3},children:[a.jsx(v,{item:!0,xs:12,md:7,children:a.jsx(ia,{title:"Performance Overview",description:"Comparison of key metrics between periods",baselinePeriod:"Previous Month",currentPeriod:"Current Month",comparisonItems:[{metric:"User Engagement",baseline:{value:6320,label:"Previous"},current:{value:8150,label:"Current"},changePercent:28.96,isPositive:!0,target:9e3,goalCompletion:90.5,notes:"User engagement significantly increased after new features release"},{metric:"Average Session Duration",baseline:{value:720,label:"Previous"},current:{value:852,label:"Current"},changePercent:18.33,isPositive:!0,unit:"s",target:900,goalCompletion:94.7},{metric:"AI Suggestions Accepted",baseline:{value:62.4,label:"Previous"},current:{value:75.8,label:"Current"},changePercent:21.47,isPositive:!0,unit:"%",target:80,goalCompletion:94.75}]})}),a.jsx(v,{item:!0,xs:12,md:5,children:a.jsx(na,{title:"UX Trends & Patterns",description:"Automatically detected trends and patterns in UX metrics",trends:[{metric:"Collaboration Feature Usage",currentValue:3240,previousValue:2150,changePercent:50.7,changeType:"increase",isPositive:!0},{metric:"WebSocket Error Rate",currentValue:.8,previousValue:2.3,changePercent:-65.2,changeType:"decrease",isPositive:!0,unit:"%"},{metric:"Mobile Session Duration",currentValue:432,previousValue:520,changePercent:-16.9,changeType:"decrease",isPositive:!1,isCritical:!0,unit:"s",notes:"Mobile sessions are getting shorter despite increased user engagement"}],patterns:[{patternType:"seasonal",description:"Weekly pattern detected with higher usage on Wednesdays and Thursdays",confidence:93,metric:"Daily Active Users",suggestion:"Consider scheduling feature releases on Mondays to maximize weekly exposure"},{patternType:"anomaly",description:"Unexpected drop in collaboration session duration on mobile devices",confidence:87,metric:"Mobile Collaboration Time",suggestion:"Investigate mobile interface issues in collaborative editing"}]})})]}),a.jsx(u,{id:"dashboard-container",ref:me,sx:{height:"100%"},children:a.jsx(aa,{availableWidgets:ca,dashboard:je,isEditing:be,onAddWidget:e=>{ve((t=>({...t,widgets:[...t.widgets,e]})))},onUpdateWidget:(e,t)=>{ve((a=>({...a,widgets:a.widgets.map((a=>a.id===e?{...a,...t}:a))})))},onRemoveWidget:e=>{ve((t=>({...t,widgets:t.widgets.filter((t=>t.id!==e))})))},onSaveDashboard:e=>{ve((t=>({...t,name:e}))),De({open:!0,message:`Dashboard saved as: ${e}`,severity:"success"})},onUpdateLayout:e=>{ve((t=>({...t,widgets:e})))},data:Ge,isLoading:qe,onExport:Je,onToggleEditMode:()=>Ce((e=>!e))})})]}),a.jsx(sa,{value:pe,index:1,children:a.jsxs(v,{container:!0,spacing:3,children:[a.jsx(v,{item:!0,xs:12,md:8,children:a.jsx(Ht,{title:"Feature Usage Trends",description:"Daily usage of different features over time",data:(null==(s=Oe.data)?void 0:s.dailyUsage)||[],dataKeys:["aiAssistant","collaboration","contentCreation","dashboard"],yAxisLabel:"Usage Count",height:400,formatValue:e=>`${e.toLocaleString()}`,showControls:!0,referenceLines:[{value:800,label:"Target Usage",color:"#4caf50"}],annotations:[{date:(null==(h=null==(l=null==(o=Oe.data)?void 0:o.dailyUsage)?void 0:l[20])?void 0:h.date)||"",text:"New Feature Launch",color:"#f44336"},{date:(null==(f=null==(m=null==(x=Oe.data)?void 0:x.dailyUsage)?void 0:m[25])?void 0:f.date)||"",text:"Marketing Campaign",color:"#2196f3"}],onExport:e=>{De({open:!0,message:`Chart exported as ${e.toUpperCase()}`,severity:"success"})}})}),a.jsx(v,{item:!0,xs:12,md:4,children:a.jsx(Jt,{title:"User Type Distribution",description:"Breakdown of usage by user type",data:(null==(y=Oe.data)?void 0:y.userTypeDistribution)||[],height:400,formatValue:e=>`${e.toLocaleString()} users`})}),a.jsx(v,{item:!0,xs:12,children:a.jsx(Xt,{title:"Feature Usage Heatmap",description:"Usage patterns by time of day and day of week",data:(null==(b=Oe.data)?void 0:b.heatmapData)||[],xLabels:(null==(C=Oe.data)?void 0:C.heatmapXLabels)||[],yLabels:(null==(w=Oe.data)?void 0:w.heatmapYLabels)||[],colorScale:["#e0f7fa","#006064"],height:450})}),a.jsx(v,{item:!0,xs:12,md:6,children:a.jsx(D,{children:a.jsxs(M,{children:[a.jsx(p,{variant:"h6",gutterBottom:!0,children:"Feature Adoption Rate"}),a.jsx(p,{variant:"body2",color:"text.secondary",paragraph:!0,children:"Percentage of users who used each feature at least once in the selected period"}),Oe.isLoading?a.jsx(u,{sx:{display:"flex",justifyContent:"center",py:2},children:a.jsx(A,{size:40})}):a.jsx(u,{sx:{mt:2},children:((null==(S=Oe.data)?void 0:S.adoptionRates)||[]).map((e=>a.jsxs(u,{sx:{mb:2},children:[a.jsxs(u,{sx:{display:"flex",justifyContent:"space-between",mb:.5},children:[a.jsx(p,{variant:"body2",children:e.feature}),a.jsxs(p,{variant:"body2",fontWeight:"bold",children:[e.rate,"%"]})]}),a.jsx(u,{sx:{width:"100%",backgroundColor:xe.palette.grey[200],borderRadius:1},children:a.jsx(u,{sx:{height:8,borderRadius:1,backgroundColor:xe.palette.primary.main,width:`${e.rate}%`}})})]},e.feature)))})]})})}),a.jsx(v,{item:!0,xs:12,md:6,children:a.jsx(D,{sx:{height:"100%"},children:a.jsxs(M,{children:[a.jsx(p,{variant:"h6",gutterBottom:!0,children:"Key Metrics"}),a.jsx(p,{variant:"body2",color:"text.secondary",paragraph:!0,children:"Summary of feature usage and performance metrics"}),Oe.isLoading?a.jsx(u,{sx:{display:"flex",justifyContent:"center",py:2},children:a.jsx(A,{size:40})}):a.jsx(v,{container:!0,spacing:2,sx:{mt:1},children:((null==(k=Oe.data)?void 0:k.keyMetrics)||[]).map((e=>a.jsx(v,{item:!0,xs:6,children:a.jsxs(u,{sx:{p:2,border:`1px solid ${xe.palette.divider}`,borderRadius:1},children:[a.jsx(p,{variant:"body2",color:"text.secondary",children:e.name}),a.jsx(p,{variant:"h5",component:"div",sx:{mt:1},children:e.value}),e.change&&a.jsxs(u,{sx:{display:"flex",alignItems:"center",color:e.change>0?"success.main":"error.main",mt:.5},children:[e.change>0?"↑":"↓",a.jsxs(p,{variant:"body2",component:"span",sx:{ml:.5},children:[Math.abs(e.change),"%"]})]})]})},e.name)))})]})})})]})}),a.jsx(sa,{value:pe,index:2,children:a.jsxs(v,{container:!0,spacing:3,children:[a.jsx(v,{item:!0,xs:12,md:8,children:a.jsx(Ht,{title:"AI Assistant Performance",description:"Acceptance rate and quality score over time",data:(null==(R=Ue.data)?void 0:R.dailyMetrics)||[],dataKeys:["acceptanceRate","qualityScore"],yAxisLabel:"Rate (%)",height:400,formatValue:e=>`${e.toFixed(1)}%`,showControls:!0,compareWith:{label:"Previous Month",startDate:(null==(F=null==(P=null==(z=Ue.data)?void 0:z.dailyMetrics)?void 0:P[0])?void 0:F.date)||"",endDate:(null==(L=null==(E=null==(B=Ue.data)?void 0:B.dailyMetrics)?void 0:E[7])?void 0:L.date)||"",color:"#673ab7"},referencePoints:[{date:(null==(U=null==(O=null==(W=Ue.data)?void 0:W.dailyMetrics)?void 0:O[15])?void 0:U.date)||"",value:(null==(_=null==(K=null==(V=Ue.data)?void 0:V.dailyMetrics)?void 0:K[15])?void 0:_.qualityScore)||0,label:"AI Model Update",color:"#009688"}],onExport:e=>{De({open:!0,message:`Chart exported as ${e.toUpperCase()}`,severity:"success"})}})}),a.jsx(v,{item:!0,xs:12,md:4,children:a.jsx(Jt,{title:"Suggestion Type Distribution",description:"Breakdown of AI suggestions by type",data:(null==(N=Ue.data)?void 0:N.suggestionTypes)||[],height:400,formatValue:e=>`${e.toLocaleString()}`})}),a.jsx(v,{item:!0,xs:12,md:6,children:a.jsx(Ht,{title:"AI Assistant Response Time",description:"Average time to generate suggestions",data:(null==(q=Ue.data)?void 0:q.responseTimes)||[],dataKeys:["averageResponseTime"],yAxisLabel:"Time (ms)",height:300,formatValue:e=>`${e.toFixed(0)} ms`})}),a.jsx(v,{item:!0,xs:12,md:6,children:a.jsx(Ht,{title:"Cache Performance",description:"Cache hit rate for AI suggestions",data:(null==(G=Ue.data)?void 0:G.cachePerformance)||[],dataKeys:["hitRate"],yAxisLabel:"Hit Rate (%)",height:300,formatValue:e=>`${e.toFixed(1)}%`})}),a.jsx(v,{item:!0,xs:12,children:a.jsx(D,{children:a.jsxs(M,{children:[a.jsx(p,{variant:"h6",gutterBottom:!0,children:"AI Assistant Usage Insights"}),Ue.isLoading?a.jsx(u,{sx:{display:"flex",justifyContent:"center",py:2},children:a.jsx(A,{size:40})}):a.jsx(v,{container:!0,spacing:2,sx:{mt:1},children:((null==(H=Ue.data)?void 0:H.insights)||[]).map(((e,t)=>a.jsx(v,{item:!0,xs:12,md:4,children:a.jsxs(u,{sx:{p:2,border:`1px solid ${xe.palette.divider}`,borderRadius:1,height:"100%"},children:[a.jsx(p,{variant:"subtitle1",gutterBottom:!0,children:e.title}),a.jsx(p,{variant:"body2",paragraph:!0,children:e.description}),e.metrics&&a.jsxs(u,{sx:{display:"flex",justifyContent:"space-between",mt:2},children:[a.jsxs(p,{variant:"body2",color:"text.secondary",children:[e.metrics.label,":"]}),a.jsx(p,{variant:"body2",fontWeight:"medium",children:e.metrics.value})]})]})},t)))})]})})})]})}),a.jsx(sa,{value:pe,index:3,children:a.jsxs(v,{container:!0,spacing:3,children:[a.jsx(v,{item:!0,xs:12,md:6,children:a.jsx(Ht,{title:"WebSocket Connection Count",description:"Number of active connections over time",data:(null==(J=Ve.data)?void 0:J.connectionCounts)||[],dataKeys:["activeConnections"],yAxisLabel:"Connections",height:300,formatValue:e=>`${e.toLocaleString()}`})}),a.jsx(v,{item:!0,xs:12,md:6,children:a.jsx(Ht,{title:"WebSocket Message Volume",description:"Number of messages sent and received",data:(null==(X=Ve.data)?void 0:X.messageVolume)||[],dataKeys:["sent","received"],yAxisLabel:"Messages",height:300,formatValue:e=>`${e.toLocaleString()}`})}),a.jsx(v,{item:!0,xs:12,md:6,children:a.jsx(Ht,{title:"WebSocket Latency",description:"Average message latency over time",data:(null==(Y=Ve.data)?void 0:Y.latency)||[],dataKeys:["averageLatency"],yAxisLabel:"Latency (ms)",height:300,formatValue:e=>`${e.toFixed(1)} ms`})}),a.jsx(v,{item:!0,xs:12,md:6,children:a.jsx(Ht,{title:"Error Rate",description:"Percentage of failed WebSocket operations",data:(null==(Q=Ve.data)?void 0:Q.errorRate)||[],dataKeys:["errorRate"],yAxisLabel:"Error Rate (%)",height:300,formatValue:e=>`${e.toFixed(2)}%`})}),a.jsx(v,{item:!0,xs:12,children:a.jsx(D,{children:a.jsxs(M,{children:[a.jsx(p,{variant:"h6",gutterBottom:!0,children:"WebSocket Performance Summary"}),Ve.isLoading?a.jsx(u,{sx:{display:"flex",justifyContent:"center",py:2},children:a.jsx(A,{size:40})}):a.jsx(v,{container:!0,spacing:2,sx:{mt:1},children:((null==(Z=Ve.data)?void 0:Z.summary)||[]).map((e=>a.jsx(v,{item:!0,xs:6,md:3,children:a.jsxs(u,{sx:{p:2,border:`1px solid ${xe.palette.divider}`,borderRadius:1,textAlign:"center"},children:[a.jsx(p,{variant:"h5",component:"div",children:e.value}),a.jsx(p,{variant:"body2",color:"text.secondary",children:e.metric})]})},e.metric)))})]})})})]})}),a.jsx(sa,{value:pe,index:4,children:a.jsxs(v,{container:!0,spacing:3,children:[a.jsx(v,{item:!0,xs:12,children:a.jsx(D,{sx:{height:600},children:a.jsxs(M,{sx:{height:"100%",display:"flex",flexDirection:"column"},children:[a.jsx(p,{variant:"h6",gutterBottom:!0,children:"User Journey Flow"}),a.jsx(p,{variant:"body2",color:"text.secondary",paragraph:!0,children:"Visualization of common user paths through the application"}),Ke.isLoading?a.jsx(u,{sx:{display:"flex",justifyContent:"center",alignItems:"center",flexGrow:1},children:a.jsx(A,{size:40})}):a.jsx(u,{sx:{flexGrow:1},children:a.jsx(Qt,{title:"User Journey Map",nodes:(null==(ee=Ke.data)?void 0:ee.nodes)||[],connections:(null==(te=Ke.data)?void 0:te.connections)||[],height:"100%"})})]})})}),a.jsx(v,{item:!0,xs:12,md:6,children:a.jsx(Ht,{title:"User Journey Conversion Rate",description:"Percentage of users completing key journeys",data:(null==(ae=Ke.data)?void 0:ae.conversionRates)||[],dataKeys:["contentCreation","collaboration","publishing"],yAxisLabel:"Conversion Rate (%)",height:300,formatValue:e=>`${e.toFixed(1)}%`})}),a.jsx(v,{item:!0,xs:12,md:6,children:a.jsx(Ht,{title:"Average Journey Time",description:"Time taken to complete key user journeys",data:(null==(re=Ke.data)?void 0:re.journeyTimes)||[],dataKeys:["contentCreation","collaboration","publishing"],yAxisLabel:"Time (seconds)",height:300,formatValue:e=>`${e.toFixed(0)}s`})})]})}),a.jsx(sa,{value:pe,index:5,children:a.jsxs(v,{container:!0,spacing:3,children:[a.jsx(v,{item:!0,xs:12,children:a.jsx(Yt,{title:"A/B Test Results",description:"Performance comparison of different UX variants",variants:(null==(ne=_e.data)?void 0:ne.variants)||[],metrics:(null==(ie=_e.data)?void 0:ie.metrics)||[],results:(null==(se=_e.data)?void 0:se.results)||[],height:500,showRelativeChange:!0,selectedMetric:Re,onSelectMetric:Me})}),a.jsx(v,{item:!0,xs:12,md:6,children:a.jsx(Ht,{title:"A/B Test Performance Over Time",description:`Daily ${Re} by variant`,data:(null==(le=null==(oe=_e.data)?void 0:oe.timeSeriesData)?void 0:le[Re])||[],dataKeys:(null==(de=null==(ce=_e.data)?void 0:ce.variants)?void 0:de.map((e=>e.id)))||[],yAxisLabel:"Value",height:350,formatValue:e=>Re.includes("Rate")?`${e.toFixed(1)}%`:e.toString()})}),a.jsx(v,{item:!0,xs:12,md:6,children:a.jsx(D,{sx:{height:"100%"},children:a.jsxs(M,{children:[a.jsx(p,{variant:"h6",gutterBottom:!0,children:"Test Insights"}),a.jsx(p,{variant:"body2",color:"text.secondary",paragraph:!0,children:"Key findings and statistical analysis"}),_e.isLoading?a.jsx(u,{sx:{display:"flex",justifyContent:"center",py:2},children:a.jsx(A,{size:40})}):a.jsx(u,{children:((null==(he=_e.data)?void 0:he.insights)||[]).map(((e,t)=>a.jsxs(u,{sx:{p:2,mb:2,border:`1px solid ${xe.palette.divider}`,borderLeft:`4px solid ${e.isPositive?xe.palette.success.main:xe.palette.warning.main}`,borderRadius:1},children:[a.jsx(p,{variant:"subtitle1",gutterBottom:!0,children:e.title}),a.jsx(p,{variant:"body2",children:e.description}),e.confidence&&a.jsxs(p,{variant:"body2",color:"text.secondary",sx:{mt:1},children:["Confidence: ",e.confidence,"%"]})]},t)))})]})})})]})}),a.jsx(sa,{value:pe,index:6,children:a.jsxs(v,{container:!0,spacing:3,children:[a.jsx(v,{item:!0,xs:12,md:8,children:a.jsx(ra,{insights:Ne.data||[],isLoading:Ne.isLoading,onInsightSave:(e,t)=>{De({open:!0,message:t?"Insight saved":"Insight unsaved",severity:"success"})},onRefresh:()=>ue.invalidateQueries(["uxInsights"]),onCreateAlert:e=>{De({open:!0,message:"Alert created for this insight",severity:"success"})}})}),a.jsx(v,{item:!0,xs:12,md:4,children:a.jsx(D,{sx:{height:"100%"},children:a.jsxs(M,{children:[a.jsx(p,{variant:"h6",gutterBottom:!0,children:"Insight Categories"}),a.jsx(p,{variant:"body2",color:"text.secondary",paragraph:!0,children:"Filter insights by category"}),a.jsx(u,{sx:{display:"flex",flexDirection:"column",gap:2},children:["performance","anomaly","trend","opportunity","prediction"].map((e=>{const t=(Ne.data||[]).filter((t=>t.category===e)).length;return a.jsxs(g,{variant:"outlined",sx:{justifyContent:"space-between",textTransform:"capitalize",py:1.5},onClick:()=>{},children:[e,a.jsx(u,{sx:{backgroundColor:xe.palette.action.hover,borderRadius:"50%",width:24,height:24,display:"flex",alignItems:"center",justifyContent:"center",fontWeight:"bold",fontSize:"0.75rem"},children:t})]},e)}))}),a.jsxs(u,{sx:{mt:4},children:[a.jsx(p,{variant:"h6",gutterBottom:!0,children:"Export Insights"}),a.jsx(p,{variant:"body2",color:"text.secondary",paragraph:!0,children:"Download insights as a report"}),a.jsx(g,{variant:"contained",fullWidth:!0,onClick:()=>{De({open:!0,message:"Insights exported successfully",severity:"success"})},children:"Export as PDF"}),a.jsx(g,{variant:"outlined",fullWidth:!0,sx:{mt:1},onClick:()=>{De({open:!0,message:"Insights exported as CSV",severity:"success"})},children:"Export as CSV"})]})]})})})]})})]}),a.jsx(He,{open:Ie.open,autoHideDuration:5e3,onClose:Xe,anchorOrigin:{vertical:"bottom",horizontal:"right"},children:a.jsx(I,{onClose:Xe,severity:Ie.severity,variant:"filled",children:Ie.message})})]})},xa={1:{brandId:"1",contentMetrics:{totalContentItems:24,publishedItems:18,averageScore:87,topPerformingType:"blog",engagementRate:5.2,conversionRate:2.7,totalViews:47500},campaignMetrics:{activeCampaigns:3,totalSpend:15e3,totalRevenue:42e3,averageROI:2.8,bestPerformingPlatform:"linkedin",conversionRate:3.2,clickThroughRate:4.5},socialMetrics:{totalFollowers:24500,followersGrowth:8.3,engagementRate:3.7,topPerformingPlatform:"linkedin",averageReach:12e3,averageImpressions:18500},websiteMetrics:{visitors:35e3,pageViews:105e3,averageSessionDuration:2.5,bounceRate:42,topReferrer:"google",organicTraffic:22e3,paidTraffic:13e3}},2:{brandId:"2",contentMetrics:{totalContentItems:32,publishedItems:25,averageScore:92,topPerformingType:"social",engagementRate:7.8,conversionRate:3.4,totalViews:67800},campaignMetrics:{activeCampaigns:2,totalSpend:8500,totalRevenue:27200,averageROI:3.2,bestPerformingPlatform:"instagram",conversionRate:4.1,clickThroughRate:5.7},socialMetrics:{totalFollowers:42e3,followersGrowth:12.5,engagementRate:6.2,topPerformingPlatform:"instagram",averageReach:28e3,averageImpressions:42500},websiteMetrics:{visitors:28500,pageViews:84300,averageSessionDuration:3.2,bounceRate:38,topReferrer:"instagram",organicTraffic:17800,paidTraffic:10700}},3:{brandId:"3",contentMetrics:{totalContentItems:29,publishedItems:22,averageScore:94,topPerformingType:"video",engagementRate:8.4,conversionRate:4.2,totalViews:82400},campaignMetrics:{activeCampaigns:4,totalSpend:18700,totalRevenue:65450,averageROI:3.5,bestPerformingPlatform:"facebook",conversionRate:5.3,clickThroughRate:6.8},socialMetrics:{totalFollowers:56e3,followersGrowth:15.2,engagementRate:7.5,topPerformingPlatform:"facebook",averageReach:35e3,averageImpressions:52e3},websiteMetrics:{visitors:42e3,pageViews:136500,averageSessionDuration:4.1,bounceRate:32,topReferrer:"facebook",organicTraffic:24800,paidTraffic:17200}},4:{brandId:"4",contentMetrics:{totalContentItems:18,publishedItems:14,averageScore:89,topPerformingType:"image",engagementRate:6.7,conversionRate:2.9,totalViews:36200},campaignMetrics:{activeCampaigns:2,totalSpend:10200,totalRevenue:28560,averageROI:2.8,bestPerformingPlatform:"pinterest",conversionRate:3.8,clickThroughRate:5.2},socialMetrics:{totalFollowers:32500,followersGrowth:10.8,engagementRate:5.4,topPerformingPlatform:"pinterest",averageReach:23500,averageImpressions:34600},websiteMetrics:{visitors:22800,pageViews:76500,averageSessionDuration:3.8,bounceRate:35,topReferrer:"pinterest",organicTraffic:14600,paidTraffic:8200}}},ua=(e,t,a)=>{const r=new Date,n=[];for(let i=0;i<a;i++){const s=new Date(r);s.setDate(s.getDate()-(a-i-1));const o=1+i/(2*a),l=.8+.4*Math.random(),c=Math.round(e*o*l*t);n.push({date:s.toISOString().split("T")[0],value:c})}return n},ma={1:{views:ua(1500,1,30),engagement:ua(75,1,30),conversions:ua(40,1,30),followers:ua(800,1,30)},2:{views:ua(2200,1,30),engagement:ua(170,1,30),conversions:ua(75,1,30),followers:ua(1400,1,30)},3:{views:ua(2700,1,30),engagement:ua(230,1,30),conversions:ua(125,1,30),followers:ua(1850,1,30)},4:{views:ua(1200,1,30),engagement:ua(80,1,30),conversions:ua(45,1,30),followers:ua(1050,1,30)}};const pa=new class{async getAnalyticsOverview(e){try{return await It.get(`/analytics/brands/${e}/overview`)}catch(t){return xa[e]?Promise.resolve({...xa[e]}):Promise.resolve({...xa[1]})}}async getTimeSeriesData(e,t,a){try{return await It.get(`/analytics/brands/${e}/timeseries/${t}`,{params:a})}catch(r){const a=ma[e]||ma[1];switch(t){case"views":default:return Promise.resolve([...a.views]);case"engagement":return Promise.resolve([...a.engagement]);case"conversions":return Promise.resolve([...a.conversions]);case"followers":return Promise.resolve([...a.followers])}}}},ga=e=>{const{children:t,value:r,index:n,...i}=e;return a.jsx("div",{role:"tabpanel",hidden:r!==n,id:`analytics-tabpanel-${n}`,"aria-labelledby":`analytics-tab-${n}`,style:{overflow:"auto"},...i,children:r===n&&a.jsx(u,{sx:{pt:3,maxHeight:"calc(100vh - 200px)",overflow:"auto"},children:t})})},fa=()=>{const[e,t]=r.useState(0),[n,s]=r.useState(!1),[o,l]=r.useState(null),[c,d]=r.useState(!1),[h,y]=r.useState(null),[j,b]=r.useState({show:!1,message:"",severity:"info"}),{selectedBrand:C}=i((e=>e.brands)),w=r.useCallback((async()=>{if(null==C?void 0:C.id){d(!0),y(null);try{const e=await pa.getAnalyticsOverview(C.id);if(!(e&&e.contentMetrics&&e.campaignMetrics&&e.socialMetrics&&e.websiteMetrics))throw new TypeError("Incomplete analytics data received");l(e),h&&b({show:!0,message:"Analytics data loaded successfully",severity:"success"})}catch(e){const t=(e=>{if(ut.isAxiosError(e)){const t=e;if("ECONNABORTED"===t.code)return{type:"timeout",message:"Request timed out. Please try again.",retry:!0};if(!t.response)return{type:"network",message:"Network error. Please check your internet connection.",details:t.message,retry:!0};switch(t.response.status){case 401:case 403:return{type:"authorization",message:"You do not have permission to access this data.",details:"Please check your login credentials or contact an administrator.",retry:!1};case 404:return{type:"not_found",message:"Analytics data not found for this brand.",details:"The requested analytics data could not be found.",retry:!1};case 500:case 502:case 503:case 504:return{type:"server",message:"Server error. Our team has been notified.",details:`Status: ${t.response.status}. Please try again later.`,retry:!0};default:return{type:"unknown",message:"An unexpected error occurred.",details:t.message,retry:!0}}}return e instanceof TypeError?{type:"data_parsing",message:"Error processing the data.",details:e.message,retry:!0}:{type:"unknown",message:"An unexpected error occurred.",details:e instanceof Error?e.message:String(e),retry:!0}})(e);y(t),l(null)}finally{d(!1)}}else l(null)}),[C,h]);r.useEffect((()=>{w();const e=setInterval((()=>{(null==C?void 0:C.id)&&w()}),3e5);return()=>{clearInterval(e)}}),[C,w]),r.useEffect((()=>{const e=()=>{"network"===(null==h?void 0:h.type)&&(null==C?void 0:C.id)&&(b({show:!0,message:"You are back online. Refreshing data...",severity:"info"}),w())};return window.addEventListener("online",e),()=>{window.removeEventListener("online",e)}}),[h,C,w]);const S=()=>{s(!n)},k=()=>{w()},R=()=>{b({...j,show:!1})},F=(e,t)=>{if(null==e)return"N/A";try{return t?t(e):e}catch(a){return"Error"}};return a.jsx(Ot,{children:a.jsxs(u,{children:[a.jsxs(u,{sx:{mb:4,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[a.jsx(p,{variant:"h4",component:"h1",fontWeight:"bold",children:"Analytics"}),a.jsxs(u,{display:"flex",alignItems:"center",children:[a.jsx(H,{title:"Refresh data",children:a.jsx(P,{onClick:k,disabled:c||!C,"aria-label":"Refresh analytics data",sx:{mr:1},children:a.jsx(f,{})})}),a.jsx(H,{title:"Accessibility Settings",children:a.jsx(P,{onClick:S,"aria-label":"Open chart accessibility settings",sx:{mr:2},children:a.jsx(re,{})})}),a.jsx(g,{variant:"contained",disabled:!o,children:"Export Report"})]})]}),a.jsxs(x,{sx:{width:"100%",mb:4},children:[a.jsxs(T,{value:e,onChange:(e,a)=>{t(a)},indicatorColor:"primary",textColor:"primary",variant:"scrollable",scrollButtons:"auto","aria-label":"Analytics dashboard tabs",children:[a.jsx($,{label:"Overview",id:"analytics-tab-0","aria-controls":"analytics-tabpanel-0"}),a.jsx($,{label:"AI API Metrics",id:"analytics-tab-1","aria-controls":"analytics-tabpanel-1"}),a.jsx($,{label:"UX Analytics",id:"analytics-tab-2","aria-controls":"analytics-tabpanel-2"}),a.jsx($,{label:"Content Performance",id:"analytics-tab-3","aria-controls":"analytics-tabpanel-3"}),a.jsx($,{label:"Campaign Analytics",id:"analytics-tab-4","aria-controls":"analytics-tabpanel-4"})]}),a.jsxs(ga,{value:e,index:0,children:[a.jsx(p,{variant:"h5",component:"h2",gutterBottom:!0,children:"Dashboard Overview"}),!C&&a.jsx(I,{severity:"info",sx:{mb:3},children:"Please select a brand from the dropdown in the header to view brand-specific analytics."}),c&&a.jsx(u,{sx:{display:"flex",justifyContent:"center",my:4},children:a.jsx(A,{})}),h&&(h?a.jsxs(I,{severity:"error",sx:{mb:3},action:h.retry?a.jsx(g,{color:"inherit",size:"small",onClick:k,startIcon:a.jsx(f,{}),children:"Retry"}):void 0,icon:a.jsx(m,{}),children:[a.jsx(Je,{children:h.message}),h.details&&a.jsx(p,{variant:"body2",children:h.details}),"network"===h.type&&a.jsx(p,{variant:"body2",sx:{mt:1},children:"Please check your internet connection and try again."}),"authorization"===h.type&&a.jsx(p,{variant:"body2",sx:{mt:1},children:"If you believe this is an error, please contact support."})]}):null),!c&&o&&a.jsxs(v,{container:!0,spacing:3,children:[a.jsx(v,{item:!0,xs:12,md:6,children:a.jsx(D,{variant:"outlined",children:a.jsxs(M,{children:[a.jsx(p,{variant:"h6",gutterBottom:!0,children:"Content Performance"}),a.jsx(z,{sx:{mb:2}}),a.jsxs(v,{container:!0,spacing:2,children:[a.jsxs(v,{item:!0,xs:6,children:[a.jsx(p,{variant:"body2",color:"text.secondary",children:"Total Content Items"}),a.jsx(p,{variant:"h6",children:F(o.contentMetrics.totalContentItems)})]}),a.jsxs(v,{item:!0,xs:6,children:[a.jsx(p,{variant:"body2",color:"text.secondary",children:"Published Items"}),a.jsx(p,{variant:"h6",children:F(o.contentMetrics.publishedItems)})]}),a.jsxs(v,{item:!0,xs:6,children:[a.jsx(p,{variant:"body2",color:"text.secondary",children:"Average Score"}),a.jsx(p,{variant:"h6",children:F(o.contentMetrics.averageScore,(e=>`${e}/100`))})]}),a.jsxs(v,{item:!0,xs:6,children:[a.jsx(p,{variant:"body2",color:"text.secondary",children:"Top Performing Type"}),a.jsx(p,{variant:"h6",children:F(o.contentMetrics.topPerformingType)})]}),a.jsxs(v,{item:!0,xs:6,children:[a.jsx(p,{variant:"body2",color:"text.secondary",children:"Total Views"}),a.jsx(p,{variant:"h6",children:F(o.contentMetrics.totalViews,(e=>e.toLocaleString()))})]}),a.jsxs(v,{item:!0,xs:6,children:[a.jsx(p,{variant:"body2",color:"text.secondary",children:"Engagement Rate"}),a.jsx(p,{variant:"h6",children:F(o.contentMetrics.engagementRate,(e=>`${e}%`))})]})]})]})})}),a.jsx(v,{item:!0,xs:12,md:6,children:a.jsx(D,{variant:"outlined",children:a.jsxs(M,{children:[a.jsx(p,{variant:"h6",gutterBottom:!0,children:"Campaign Performance"}),a.jsx(z,{sx:{mb:2}}),a.jsxs(v,{container:!0,spacing:2,children:[a.jsxs(v,{item:!0,xs:6,children:[a.jsx(p,{variant:"body2",color:"text.secondary",children:"Active Campaigns"}),a.jsx(p,{variant:"h6",children:o.campaignMetrics.activeCampaigns})]}),a.jsxs(v,{item:!0,xs:6,children:[a.jsx(p,{variant:"body2",color:"text.secondary",children:"Total Spend"}),a.jsxs(p,{variant:"h6",children:["$",o.campaignMetrics.totalSpend.toLocaleString()]})]}),a.jsxs(v,{item:!0,xs:6,children:[a.jsx(p,{variant:"body2",color:"text.secondary",children:"Total Revenue"}),a.jsxs(p,{variant:"h6",children:["$",o.campaignMetrics.totalRevenue.toLocaleString()]})]}),a.jsxs(v,{item:!0,xs:6,children:[a.jsx(p,{variant:"body2",color:"text.secondary",children:"Average ROI"}),a.jsxs(p,{variant:"h6",children:[o.campaignMetrics.averageROI,"x"]})]}),a.jsxs(v,{item:!0,xs:6,children:[a.jsx(p,{variant:"body2",color:"text.secondary",children:"Best Platform"}),a.jsx(p,{variant:"h6",children:o.campaignMetrics.bestPerformingPlatform})]}),a.jsxs(v,{item:!0,xs:6,children:[a.jsx(p,{variant:"body2",color:"text.secondary",children:"Conversion Rate"}),a.jsxs(p,{variant:"h6",children:[o.campaignMetrics.conversionRate,"%"]})]})]})]})})}),a.jsx(v,{item:!0,xs:12,md:6,children:a.jsx(D,{variant:"outlined",children:a.jsxs(M,{children:[a.jsx(p,{variant:"h6",gutterBottom:!0,children:"Social Media Performance"}),a.jsx(z,{sx:{mb:2}}),a.jsxs(v,{container:!0,spacing:2,children:[a.jsxs(v,{item:!0,xs:6,children:[a.jsx(p,{variant:"body2",color:"text.secondary",children:"Total Followers"}),a.jsx(p,{variant:"h6",children:o.socialMetrics.totalFollowers.toLocaleString()})]}),a.jsxs(v,{item:!0,xs:6,children:[a.jsx(p,{variant:"body2",color:"text.secondary",children:"Followers Growth"}),a.jsxs(p,{variant:"h6",children:[o.socialMetrics.followersGrowth,"%"]})]}),a.jsxs(v,{item:!0,xs:6,children:[a.jsx(p,{variant:"body2",color:"text.secondary",children:"Engagement Rate"}),a.jsxs(p,{variant:"h6",children:[o.socialMetrics.engagementRate,"%"]})]}),a.jsxs(v,{item:!0,xs:6,children:[a.jsx(p,{variant:"body2",color:"text.secondary",children:"Top Platform"}),a.jsx(p,{variant:"h6",children:o.socialMetrics.topPerformingPlatform})]}),a.jsxs(v,{item:!0,xs:6,children:[a.jsx(p,{variant:"body2",color:"text.secondary",children:"Average Reach"}),a.jsx(p,{variant:"h6",children:o.socialMetrics.averageReach.toLocaleString()})]}),a.jsxs(v,{item:!0,xs:6,children:[a.jsx(p,{variant:"body2",color:"text.secondary",children:"Average Impressions"}),a.jsx(p,{variant:"h6",children:o.socialMetrics.averageImpressions.toLocaleString()})]})]})]})})}),a.jsx(v,{item:!0,xs:12,md:6,children:a.jsx(D,{variant:"outlined",children:a.jsxs(M,{children:[a.jsx(p,{variant:"h6",gutterBottom:!0,children:"Website Performance"}),a.jsx(z,{sx:{mb:2}}),a.jsxs(v,{container:!0,spacing:2,children:[a.jsxs(v,{item:!0,xs:6,children:[a.jsx(p,{variant:"body2",color:"text.secondary",children:"Visitors"}),a.jsx(p,{variant:"h6",children:o.websiteMetrics.visitors.toLocaleString()})]}),a.jsxs(v,{item:!0,xs:6,children:[a.jsx(p,{variant:"body2",color:"text.secondary",children:"Page Views"}),a.jsx(p,{variant:"h6",children:o.websiteMetrics.pageViews.toLocaleString()})]}),a.jsxs(v,{item:!0,xs:6,children:[a.jsx(p,{variant:"body2",color:"text.secondary",children:"Avg. Session Duration"}),a.jsxs(p,{variant:"h6",children:[o.websiteMetrics.averageSessionDuration," min"]})]}),a.jsxs(v,{item:!0,xs:6,children:[a.jsx(p,{variant:"body2",color:"text.secondary",children:"Bounce Rate"}),a.jsxs(p,{variant:"h6",children:[o.websiteMetrics.bounceRate,"%"]})]}),a.jsxs(v,{item:!0,xs:6,children:[a.jsx(p,{variant:"body2",color:"text.secondary",children:"Organic Traffic"}),a.jsx(p,{variant:"h6",children:o.websiteMetrics.organicTraffic.toLocaleString()})]}),a.jsxs(v,{item:!0,xs:6,children:[a.jsx(p,{variant:"body2",color:"text.secondary",children:"Paid Traffic"}),a.jsx(p,{variant:"h6",children:o.websiteMetrics.paidTraffic.toLocaleString()})]})]})]})})})]})]}),a.jsx(ga,{value:e,index:1,children:a.jsx(Et,{})}),a.jsx(ga,{value:e,index:2,children:a.jsx(ha,{})}),a.jsxs(ga,{value:e,index:3,children:[a.jsx(p,{variant:"h5",component:"h2",gutterBottom:!0,children:"Content Performance"}),a.jsx(p,{variant:"body1",children:"Content performance analytics coming soon."})]}),a.jsxs(ga,{value:e,index:4,children:[a.jsx(p,{variant:"h5",component:"h2",gutterBottom:!0,children:"Campaign Analytics"}),a.jsx(p,{variant:"body1",children:"Campaign analytics coming soon."})]})]}),n&&a.jsx(u,{sx:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",zIndex:1300,display:"flex",alignItems:"center",justifyContent:"center",p:2},onClick:e=>{e.target===e.currentTarget&&S()},children:a.jsx(u,{sx:{width:"100%",maxWidth:600,maxHeight:"90vh",overflow:"auto",borderRadius:1},onClick:e=>e.stopPropagation(),children:a.jsx(Kt,{onClose:S})})}),a.jsx(He,{open:j.show,autoHideDuration:6e3,onClose:R,anchorOrigin:{vertical:"bottom",horizontal:"right"},children:a.jsx(I,{onClose:R,severity:j.severity,children:j.message})})]})})};export{Yt as A,Rt as G,St as a,It as b,Dt as c,fa as d,kt as s};
